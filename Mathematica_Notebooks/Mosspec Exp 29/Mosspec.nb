(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    195134,       4668]
NotebookOptionsPosition[    189523,       4494]
NotebookOutlinePosition[    191078,       4543]
CellTagsIndexPosition[    190793,       4533]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Mosspec: Process M\[ODoubleDot]ssbauer Spectrum Files\
\>", "Subtitle",
 CellChangeTimes->{{3.448309521591875*^9, 3.448309559779375*^9}, {
  3.449236220296875*^9, 3.449236223*^9}, {3.44924153975*^9, 
  3.4492415428125*^9}, {3.44949072536625*^9, 3.449490754725625*^9}, {
  3.449501168788125*^9, 3.449501168788125*^9}}],

Cell["\<\

Package Initialization\
\>", "Subsubtitle",
 CellMargins->{{27., 37.75}, {8., 2.}},
 CellChangeTimes->{{3.4458752524588747`*^9, 3.4458752667088747`*^9}, 
   3.4458754209276247`*^9, {3.4458815470682497`*^9, 3.4458815500369997`*^9}, {
   3.4458815809588747`*^9, 3.4458815834901247`*^9}, {3.4458827533026247`*^9, 
   3.4458827836463747`*^9}, {3.4458874155526247`*^9, 3.4458874441307497`*^9}, 
   3.446235170296875*^9, 3.44957682071*^9},
 TextAlignment->Center,
 FontWeight->"Bold",
 CellTags->"Package Initialization and Definitions"],

Cell["\<\
This section contains the initialization code and the definitions of the \
functions and variables in this Mosspec package.\
\>", "Text",
 CellMargins->{{28, 10}, {7, 7}},
 CellChangeTimes->{{3.4260833181764402`*^9, 3.426083630229455*^9}, 
   3.4260876993198433`*^9, {3.4458677525526247`*^9, 3.4458679420526247`*^9}, {
   3.4458680556932497`*^9, 3.4458680765213747`*^9}, {3.4458681385682497`*^9, 
   3.4458681497401247`*^9}, {3.4458683009901247`*^9, 
   3.4458685003651247`*^9}, {3.4458687230213747`*^9, 
   3.4458687406307497`*^9}, {3.4458687737401247`*^9, 
   3.4458692284432497`*^9}, {3.4458709446932497`*^9, 
   3.4458711077401247`*^9}, {3.4458711562088747`*^9, 
   3.4458711718807497`*^9}, {3.4458713411932497`*^9, 
   3.4458714768182497`*^9}, {3.4458718783026247`*^9, 3.4458719183182497`*^9}, 
   3.4458720004432497`*^9, {3.4458820730682497`*^9, 3.4458820733494997`*^9}, {
   3.4458834001932497`*^9, 3.4458834292244997`*^9}, {3.4458866369432497`*^9, 
   3.4458867170994997`*^9}, {3.4458878431151247`*^9, 3.4458880190526247`*^9}, 
   3.446235170296875*^9, {3.44957407196*^9, 3.44957407671*^9}},
 TextJustification->1.,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 "Initialization: Check the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " version and start the application"
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.436377537429641*^9, 3.436377556537116*^9}, {3.4363948237160997`*^9, 
   3.4363948344415226`*^9}, {3.445190682623273*^9, 3.445190705185773*^9}, 
   3.446235170296875*^9},
 CellTags->"init"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"TrueQ", "[", 
      RowBox[{"$VersionNumber", "\[GreaterEqual]", " ", "6.0"}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"v5", " ", "or", " ", 
       RowBox[{"lower", ":", " ", 
        RowBox[{"a", " ", "wrong", " ", "version", " ", "dialog"}]}]}], ",", 
      " ", 
      RowBox[{"then", " ", "close", " ", "this", " ", "notebook"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NotebookPut", "[", 
      RowBox[{"Notebook", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cell", "[", 
           RowBox[{
           "\"\<You need Mathematica v. 6 or higher to run this \
application.\>\"", ",", "\"\<Subsubtitle\>\""}], " ", "]"}], ",", 
          RowBox[{"ButtonBox", "[", 
           RowBox[{"\"\<\\tOK\\t\>\"", ",", 
            RowBox[{"ButtonFrame", "\[Rule]", "\"\<DialogBox\>\""}], ",", 
            RowBox[{"Active", "\[Rule]", "True"}], ",", 
            RowBox[{"ButtonFunction", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NotebookClose", "[", 
                RowBox[{"ButtonNotebook", "[", "]"}], "]"}], "&"}], ")"}]}], 
            ",", 
            RowBox[{"ButtonMargins", "\[Rule]", " ", "5"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ShowCellBracket", "\[Rule]", "False"}], ",", 
        RowBox[{"Saveable", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"WindowTitle", "\[Rule]", "\"\<Mosspec\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"WindowElements", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WindowFloating", "\[Rule]", " ", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"WindowFrame", "\[Rule]", " ", "\"\<ModalDialog\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"WindowSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"250", ",", "100"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"NotebookClose", "[", 
      RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"v6", " ", "or", " ", 
      RowBox[{"higher", ":", " ", 
       RowBox[{"start", " ", "CurveFit", " ", 
        RowBox[{"(", 
         RowBox[{"if", " ", "necessary"}], ")"}], " ", "and", " ", "start", 
        " ", "Mosspec"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Needs", "[", "\"\<CurveFit`\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookLocate", "[", "\"\<package\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", "All", ",", 
       "CellGroup"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluateCreateCell", "[", 
      RowBox[{"EvaluationNotebook", "[", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", "After", ",", 
       "Notebook"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4364479311381984`*^9, 3.436447939460165*^9}, {
   3.436448274832406*^9, 3.4364483457844305`*^9}, {3.436448412330118*^9, 
   3.4364484235262175`*^9}, {3.4364485307804413`*^9, 
   3.4364485371395855`*^9}, {3.4364506840567007`*^9, 3.436450699859424*^9}, {
   3.4458881693494997`*^9, 3.4458881775994997`*^9}, {3.4458882198338747`*^9, 
   3.4458882295838747`*^9}, 3.446235170296875*^9, 3.449574113131875*^9, {
   3.449574146850625*^9, 3.4495743173975*^9}, {3.4495801527725*^9, 
   3.449580153835*^9}, {3.449867727600625*^9, 3.44986775892875*^9}, {
   3.44986827371*^9, 3.44986832511625*^9}, {3.44986862749125*^9, 
   3.449868629600625*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"CurveFit for Mathematica v7.x thru v10.x, Version 1.95, \
1/2016\"\>"], "Print",
 CellChangeTimes->{3.702053885926288*^9}],

Cell[BoxData["\<\"Caltech Sophomore Physics Labs, Pasadena, CA\"\>"], "Print",
 CellChangeTimes->{3.702053885941888*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Package definition section", "Section",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.436377537429641*^9, 3.436377556537116*^9}, {3.4364475962166047`*^9, 
   3.436447598900464*^9}, {3.43644972560852*^9, 3.436449729163632*^9}, {
   3.4364627418549633`*^9, 3.436462756996736*^9}, 3.4459504157869997`*^9, {
   3.4459583702713747`*^9, 3.4459583954744997`*^9}, 3.446235170296875*^9, {
   3.4497569145694675`*^9, 3.449756923652528*^9}},
 FontSize->14,
 FontSlant->"Italic",
 CellTags->"package"],

Cell[CellGroupData[{

Cell["The public symbols defined by the package", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.436377537429641*^9, 3.436377556537116*^9}, 3.446235170296875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "[", 
       RowBox[{"$VersionNumber", "\[GreaterEqual]", " ", "7.0"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BeginPackage", "[", 
       RowBox[{"\"\<Mosspec`\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<NonlinearRegression`\>\"", ",", "\"\<CurveFit`\>\""}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$ContextPath", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<NonlinearRegression`\>\"", ",", "\"\<RegressionCommon`\>\""}], 
          "}"}], ",", "$ContextPath"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"BeginPackage", "[", 
      RowBox[{"\"\<Mosspec`\>\"", ",", 
       RowBox[{"{", "\"\<CurveFit`\>\"", "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"clear", " ", "everything", " ", "first"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "definitions", " ", "may", " ", "be", " ", "read", 
     " ", "multiple", " ", "times"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "\"\<`*\>\"", "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<`*\>\"", "]"}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.4452696043571253`*^9, 3.4452696194665003`*^9}, {
   3.4452759770758753`*^9, 3.4452760000446253`*^9}, 3.4456170253883753`*^9, {
   3.4456220295446253`*^9, 3.4456220605446253`*^9}, {3.4456882294352503`*^9, 
   3.4456883357477503`*^9}, 3.446235170296875*^9, {3.44957437205375*^9, 
   3.44957437980375*^9}, {3.449843623881875*^9, 3.449843648835*^9}}],

Cell[CellGroupData[{

Cell["Package usage statements", "Subsubsection",
 CellChangeTimes->{{3.4499247154025*^9, 3.449924726261875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mosspecPalette", "::", "usage"}], "=", 
    "\"\<Starts the Mosspec Functions palette.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LoadMosspecFile", "::", "usage"}], "=", 
    RowBox[{
    "\"\<LoadMosspecFile[filename] loads the named file containing Experiment \
29 M\[ODoubleDot]ssbauer spectrum data saved using the MOSSPEC program.\\n\\n\
\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<LoadMosspecFile[ ] (no file name given) uses the file name of the \
last file loaded or saved, as defined by the value of CurveFit's \
DataFileName.\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<LoadMosspecFile needs CurveFit in order to function.\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FeLineV", "::", "usage"}], "=", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<FeLineV[] returns a list of the standard velocities of the six \
hyperfine lines in a natural iron M\[ODoubleDot]ssbauer spectrum (in mm/sec). \
\\n\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<FeLineV[\!\(\*
StyleBox[SubscriptBox[\"v\", \"iso\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"B\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"Q\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"g\", \"ratio\"],
FontSlant->\"Italic\"]\)] returns a list of velocities of the six hyperfine \
lines in an iron M\[ODoubleDot]ssbauer spectrum (in mm/sec) calculated from \
the parameters given: \\n\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<\!\(\*
StyleBox[SubscriptBox[\"v\", \"iso\"],
FontSlant->\"Italic\"]\) :\\t Isomeric velocity shift (in mm/sec) \\n\>\"", 
     "<>", "\"\<\!\(\*
StyleBox[SubscriptBox[\"v\", \"B\"],
FontSlant->\"Italic\"]\) :\\t Hyperfine velocity shift sensitivity (in \
mm/sec) \\n\>\"", "<>", "\"\<\!\(\*
StyleBox[SubscriptBox[\"v\", \"Q\"],
FontSlant->\"Italic\"]\) :\\t Quadrupole velocity shift sensitivity (in \
mm/sec) \\n\>\"", "<>", "\"\<\!\(\*
StyleBox[SubscriptBox[\"g\", \"ratio\"],
FontSlant->\"Italic\"]\) :\\t \!\(\*SuperscriptBox[\(g\), \(*\)]\)/g \
(\!\(\*Cell[\"\"]\)ratio of gyromagnetic ratios)\\n\\n\>\"", "<>", 
     "\"\< The order of the lines in the list is the same as the order for \
FeLineIz[].\>\""}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FeLineFunction", "::", "usage"}], "=", 
    RowBox[{"\"\<FeLineFunction[\!\(\*
StyleBox[SubscriptBox[\"v\", \"iso\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"B\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"Q\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"g\", \"ratio\"],
FontSlant->\"Italic\"]\)][\!\(\*
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"]\), \!\(\*SuperscriptBox[
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"], \"*\"]\)] =\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<\!\(\*TagBox[FormBox[
RowBox[{SubscriptBox[\"v\", \"iso\"], \"+\", 
RowBox[{SubscriptBox[\"v\", \"B\"], \" \", 
RowBox[{\"(\", 
RowBox[{SubscriptBox[\"I\", \"z\"], \"-\", 
RowBox[{SubscriptBox[\"g\", \"ratio\"], \" \", \
SuperscriptBox[SubscriptBox[\"I\", \"z\"], \"*\"]}]}], \")\"}]}], \"+\", 
RowBox[{SubscriptBox[\"v\", \"Q\"], \" \", 
RowBox[{\"(\", 
RowBox[{SuperscriptBox[
RowBox[{\"(\", SuperscriptBox[SubscriptBox[\"I\", \"z\"], \"*\"], \")\"}], \
\"2\"], \"-\", FractionBox[\"5\", \"4\"]}], \")\"}]}]}],
TraditionalForm],
TraditionalForm,
Editable->True]\)\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FeLineIz", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<FeLineIz[] returns a list of pairs {\!\(\*
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"]\), \!\(\*SuperscriptBox[
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"], \"*\"]\)} for the six hyperfine lines in an iron M\
\[ODoubleDot]ssbauer spectrum. The order of the lines in the list is from \
lowest velocity to highest.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FeLineQ", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<FeLineQ[] returns a list of quadrupole component values \
(\[PlusMinus]1) for the six hyperfine lines in an iron M\[ODoubleDot]ssbauer \
spectrum. The order of the lines in the list is the same as the order for \
FeLineIz[].\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineSpectrum", "::", "usage"}], "=", 
    RowBox[{"\"\<LineSpectrum[\!\(\*
StyleBox[\"pars\",
FontSlant->\"Italic\"]\)][\!\(\*
StyleBox[\"x\",
FontSlant->\"Italic\"]\)] returns the amplitude at position \!\(\*
StyleBox[\"x\",
FontSlant->\"Italic\"]\) of an emission line spectrum determined by the \
argument list \!\(\*
StyleBox[\"pars\",
FontSlant->\"Italic\"]\). The spectrum has a baseline of 0 and consists of \
one or more positive-going Lorentzian peaks.\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", 
     "\"\<The structure of the argument list determines the number of peaks \
in the spectrum as follows:\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<LineSpectrum[{\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"2\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"3\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"4\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"5\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"6\"]\)},\!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"1\"]\),\!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"2\"]\),\[Gamma]]:  6 lines at positions \
\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\) .. \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"6\"]\), all with width \[Gamma]. Lines \
\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"3\"]\) and \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"4\"]\) have height 1, \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"2\"]\) and \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"5\"]\) have height \!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"2\"]\), and \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\) and \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"6\"]\) have height \!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"1\"]\).\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<LineSpectrum[{\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\),\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"2\"]\)},\!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"2\"]\),\[Gamma]]:  2 lines at positions \
\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\) and \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"2\"]\), both with width \[Gamma]. Line \
\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\) has height 1, \!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"2\"]\) has height \!\(\*SubscriptBox[
StyleBox[\"y\",
FontSlant->\"Italic\"], \"2\"]\).\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<LineSpectrum[{\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\)},\[Gamma]] or LineSpectrum[\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\),\[Gamma]]:  a single line at position \
\!\(\*SubscriptBox[
StyleBox[\"x\",
FontSlant->\"Italic\"], \"1\"]\) with width \[Gamma] and height 1. See \
MossSpectrum.\>\""}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MossSpectrum", "::", "usage"}], "=", 
    "\"\<MossSpectrum[LineSpectrum[\!\(\*
StyleBox[\"pars\",
FontSlant->\"Italic\"]\)],\!\(\*
StyleBox[\"depth\",
FontSlant->\"Italic\"]\)][\!\(\*
StyleBox[\"x\",
FontSlant->\"Italic\"]\)] returns the amplitude at position \!\(\*
StyleBox[\"x\",
FontSlant->\"Italic\"]\) of a simulated M\[ODoubleDot]ssbauer absorption \
spectrum corresponding to the spectrum LineSpectrum[\!\(\*
StyleBox[\"pars\",
FontSlant->\"Italic\"]\)]. It has a baseline of 1 and has lines reaching to \
\!\(\*
StyleBox[\"depth\",
FontSlant->\"Italic\"]\) below the baseline.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Calibrate", "::", "usage"}], "=", 
    RowBox[{
    "\"\<Calibrate[] performs a velocity calibration using the current \
CurveFit data set. The data must be of a Natural Iron hyperfine \
M\[ODoubleDot]ssbauer spectrum, and it must be windowed to include only the \
lower half or upper half of the double M\[ODoubleDot]ssbauer spectrum. The \
two halves of the spectrum may be calibrated independently; each calibration \
will be saved.\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<The Natural Iron spectrum is fit using the line velocities returned \
by the call: FeLineV[]. The fit determines the channel-to-velocity conversion \
used by the function ChanToVelocity[].\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalLowerQ", "::", "usage"}], "=", 
    "\"\<CalLowerQ[] returns True if a velocity calibration has been \
performed on the lower half of the MOSSPEC spectrum. See: Calibrate.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalUpperQ", "::", "usage"}], "=", 
    "\"\<CalUpperQ[] returns True if a velocity calibration has been \
performed on the upper half of the MOSSPEC spectrum. See: Calibrate.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChanToVelocity", "::", "usage"}], " ", "=", " ", 
    RowBox[{
    "\"\<ChanToVelocity[] converts the CurveFit X channel data to velocity \
(in mm/sec) using the results of Calibrate[], as saved in the list returned \
by a call to VelocityParameters[]. It uses either the lower half or upper \
half velocity calibration as appropriate. No adjustments to X sigmas are \
made, since the velocity calibration transformation introduces a systematic \
uncertainty.\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<ChanToVelocity[\!\(\*
StyleBox[\"chan\",
FontSlant->\"Italic\"]\)] converts the channel number \!\(\*
StyleBox[\"chan\",
FontSlant->\"Italic\"]\) to velocity. It uses the lower calibration if \!\(\*
StyleBox[\"chan\",
FontSlant->\"Italic\"]\) < 511, otherwise it uses the upper \
calibration.\>\""}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VelocityParameters", "::", "usage"}], "=", 
    RowBox[{
    "\"\<VelocityParameters[\\\"Lower\\\"] returns the velocity calibration \
parameters for the lower half of a MOSSPEC spectrum calculated by a call to \
Calibrate[]. VelocityParameters[\\\"Upper\\\"] returns the velocity \
calibration parameters for the upper half.\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", 
     "\"\<The returned value is a list of two numbers: {\!\(\*SubscriptBox[
StyleBox[\"channel\",
FontSlant->\"Italic\"], \"0\"]\), \!\(\*
StyleBox[\"slope\",
FontSlant->\"Italic\"]\)}, where \!\(\*SubscriptBox[
StyleBox[\"channel\",
FontSlant->\"Italic\"], \"0\"]\) is the zero-velocity channel number and \!\(\*
StyleBox[\"slope\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)is velocity per channel in mm/sec. If a velocity \
calibration has not been performed for the selected half of the spectrum, \
then the returned list is empty: {}. The conversion from channel number to \
velocity is given by: \!\(\*
StyleBox[\"velocity\",
FontSlant->\"Italic\"]\) = \!\(\*
StyleBox[\"slope\",
FontSlant->\"Italic\"]\)\[Cross](\!\(\*
StyleBox[\"channel\",
FontSlant->\"Italic\"]\) - \!\(\*SubscriptBox[
StyleBox[\"channel\",
FontSlant->\"Italic\"], \"0\"]\))\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<VelocityParameters[\\\"SigmaLower\\\"] returns the uncertainties in \
the velocity calibration parameters returned by \
VelocityParameters[\\\"Lower\\\"], and similarly for \
VelocityParameters[\\\"SigmaUpper\\\"]\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VelocitySigma", "::", "usage"}], "=", "\"\<VelocitySigma[\!\(\*
StyleBox[\"vel\",
FontSlant->\"Italic\"]\),\\\"Lower\\\"] and VelocitySigma[\!\(\*
StyleBox[\"vel\",
FontSlant->\"Italic\"]\),\\\"Upper\\\"] return the uncertainty in velocity \!\
\(\*
StyleBox[\"vel\",
FontSlant->\"Italic\"]\) resulting from the uncertainties in the velocity \
calibration parameters of the lower and upper half velocity calibration \
performed by Calibrate[]. All velocities are in mm/sec.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FitLines", "::", "usage"}], "=", 
    RowBox[{
    "\"\<FitLines[6] attempts to fit a 6-line M\[ODoubleDot]ssbauer spectrum \
to the CurveFit data (Fe, \!\(\*SubscriptBox[\(Fe\), \
\(2\)]\)\!\(\*SubscriptBox[\(O\), \(3\)]\)).\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", "\"\<FitLines[6, {\!\(\*
StyleBox[\"list\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"of\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"6\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"peak\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"positions\",
FontSlant->\"Italic\"]\)} ] attempts to fit a 6-line M\[ODoubleDot]ssbauer \
spectrum to the CurveFit data, using the list of initial peak positions \
provided as the 2nd argument.\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<FitLines[2] attempts to fit a 2-line M\[ODoubleDot]ssbauer spectrum \
to the CurveFit data (\!\(\*SubscriptBox[\(FeSO\), \(4\)]\)).\\n\\n\>\"", "<>",
      "\[IndentingNewLine]", "\"\<FitLines[2, {\!\(\*
StyleBox[\"list\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"of\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"2\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"peak\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"positions\",
FontSlant->\"Italic\"]\)} ] attempts to fit a 2-line M\[ODoubleDot]ssbauer \
spectrum to the CurveFit data, using the list of initial peak positions \
provided as the 2nd argument.\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<FitLines[1] attempts to fit a single-line M\[ODoubleDot]ssbauer \
spectrum to the CurveFit data (Stainless steel).\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", 
     "\"\<The X scale must be transformed to velocity using ChanToVelocity[] \
before calling this function.\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PeakList", "::", "usage"}], "=", 
    "\"\<PeakList[] returns a list of the positions of the peaks found by a \
call to FitLines[].\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OtherParamsList", "::", "usage"}], "=", 
    "\"\<OtherParamsList = other spectrum parameters from a 6-line fit in \
this order: {g,d,y1,y2,c,h}.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PeakSigmaList", "::", "usage"}], "=", 
    "\"\<PeakSigmaList[] returns a list of the sigmas of the positions of the \
peaks in PeakList[].\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonlinFit", "::", "usage"}], "=", "\"\<NonlinFit[\!\(\*
StyleBox[\"Data\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"Model\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"ParameterList\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"Variables\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"options\",
FontSlant->\"Italic\"]\)] provides a \!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) version-independent nonlinear regression routine. \
The argument list is the same as is used for NonlinearRegress[] (\!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) v6) and NonlinearModelFit[] (\!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) v7).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelPeaks", "::", "usage"}], "=", 
   RowBox[{"\"\<ModelPeaks[\!\(\*
StyleBox[\"PeakList\",
FontSlant->\"Italic\"]\)] fits a list of 6 peak positions (in mm/sec) to the \
theoretical model given by: \\nFeLineFunction[\!\(\*
StyleBox[SubscriptBox[\"v\", \"iso\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"B\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"v\", \"Q\"],
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[SubscriptBox[\"g\", \"ratio\"],
FontSlant->\"Italic\"]\)][\!\(\*
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"]\), \!\(\*SuperscriptBox[
StyleBox[SubscriptBox[\"I\", \"z\"],
FontSlant->\"Italic\"], \"*\"]\)]\\n\\n\>\"", "<>", "\"\<\!\(\*TagBox[FormBox[
RowBox[{\"ModelPeaks\", \"[\", 
StyleBox[
RowBox[{\"PeakList\", \",\", \"SigmaList\"}],
FontSlant->\"Italic\"], \"]\"}],
TraditionalForm],
TraditionalForm,
Editable->True]\) fits the data with a list of 6 peak uncertainties in \
SigmaList. The functions PeakList[] and PeakSigmaList[] may be used as \
arguments to ModelPeaks after you have fit a spectrum of 6 lines.\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.449495913975625*^9, 3.449496152288125*^9}, {
   3.449498420694375*^9, 3.449498455506875*^9}, {3.449498629756875*^9, 
   3.4494986323975*^9}, {3.4494986701475*^9, 3.449498716663125*^9}, 
   3.449498800835*^9, {3.449574413319375*^9, 3.44957446336625*^9}, 
   3.449574585913125*^9, {3.449574740131875*^9, 3.449574742819375*^9}, {
   3.449604393631875*^9, 3.44960455849125*^9}, {3.44960472024125*^9, 
   3.449604996506875*^9}, {3.449605059381875*^9, 3.449605079475625*^9}, {
   3.4497517419115505`*^9, 3.4497517678488464`*^9}, {3.449751809138218*^9, 
   3.449751862454883*^9}, {3.4497520583665905`*^9, 3.44975207006341*^9}, {
   3.4497524383129263`*^9, 3.4497524852604337`*^9}, {3.449752536023427*^9, 
   3.4497525744887376`*^9}, {3.4497526117923775`*^9, 
   3.4497528963415394`*^9}, {3.4497529513105807`*^9, 
   3.4497530435131617`*^9}, {3.4497587228496466`*^9, 
   3.4497587465236883`*^9}, {3.449759348208869*^9, 3.449759360276221*^9}, {
   3.449760230557624*^9, 3.449760243416114*^9}, {3.4497727614361424`*^9, 
   3.4497727752560143`*^9}, {3.449841964694375*^9, 3.449842388256875*^9}, {
   3.44984242224125*^9, 3.449842574444375*^9}, {3.44984262296*^9, 
   3.449842724475625*^9}, {3.449842846225625*^9, 3.449843171975625*^9}, {
   3.449843215756875*^9, 3.4498433308975*^9}, 3.4498433782725*^9, {
   3.449843799600625*^9, 3.4498438240225*^9}, {3.449845177413125*^9, 
   3.449845501335*^9}, {3.449845532225625*^9, 3.449845586600625*^9}, 
   3.44984561821*^9, {3.4498458501475*^9, 3.449846024256875*^9}, {
   3.449846057163125*^9, 3.449846113131875*^9}, {3.449849282835*^9, 
   3.4498494031475*^9}, 3.449850330913125*^9, 3.44985054271*^9, {
   3.44985591967875*^9, 3.449855930975625*^9}, {3.4498589770225*^9, 
   3.44985924117875*^9}, {3.449869539506875*^9, 3.449869837756875*^9}, {
   3.449869899413125*^9, 3.4498702167725*^9}, {3.44987024705375*^9, 
   3.4498707433975*^9}, {3.449870997663125*^9, 3.449871019413125*^9}, {
   3.450012278426138*^9, 3.4500123660745335`*^9}, {3.450012410898642*^9, 
   3.450012682202456*^9}, {3.4500127309012175`*^9, 3.4500128349700165`*^9}, {
   3.4500128861373067`*^9, 3.4500129174782486`*^9}, {3.4500135203461018`*^9, 
   3.4500135461250415`*^9}, {3.4500150142122393`*^9, 3.450015123249344*^9}, {
   3.450015173854184*^9, 3.4500153734612975`*^9}, {3.4500154811079016`*^9, 
   3.450015543086723*^9}, {3.4500155794115925`*^9, 3.4500156387968965`*^9}, {
   3.452019489551125*^9, 3.452019494738625*^9}, {3.452019562519875*^9, 
   3.4520196357855*^9}, {3.452019684644875*^9, 3.45201971056675*^9}, {
   3.452019915723*^9, 3.45202004056675*^9}, {3.452020107301125*^9, 
   3.452020108723*^9}, {3.452021142894875*^9, 3.452021150551125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Constants from ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s Units and PhysicalConstants packages"
}], "Subsubsection",
 CellChangeTimes->{{3.4499247154025*^9, 3.449924782668125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"E0", "::", "usage"}], "=", 
   RowBox[{
   "\"\<E0 = The iron M\[ODoubleDot]ssbauer \[Gamma] energy in eV. \
Mathematica code to get this value:\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<\!\(\*SuperscriptBox[\(10\), \
\(3\)]\)(IsotopeData[\\\"Fe57\\\",\\\"ExcitedStateEnergies\\\"]//First)\>\""}]\
}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E0", "=", "14412.9"}], ";"}]}], "Input",
 CellChangeTimes->{{3.449924838011875*^9, 3.4499250161525*^9}, {
   3.44992505149625*^9, 3.449925053605625*^9}, 3.449926361793125*^9, {
   3.44993056955875*^9, 3.44993057199625*^9}, {3.4499307084025*^9, 
   3.449930708730625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cLight", "::", "usage"}], "=", 
   RowBox[{
   "\"\<cLight = The speed of light in meters/sec. Mathematica code to get \
this value:\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<Needs[\\\"Units`\\\"]\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<Needs[\\\"PhysicalConstants`\\\"]\\n\>\"", "<>", 
    "\[IndentingNewLine]", "\"\<SpeedOfLight/(Meter/Second)\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cLight", "=", "299792458"}], ";"}]}], "Input",
 CellChangeTimes->{{3.449924838011875*^9, 3.4499250161525*^9}, {
  3.44992505149625*^9, 3.449925053605625*^9}, {3.449925722730625*^9, 
  3.449925844715*^9}, {3.449925928355625*^9, 3.44992604393375*^9}, {
  3.4499306007775*^9, 3.44993060234*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g", "::", "usage"}], "=", 
   RowBox[{
   "\"\<g = The iron ground state gyromagnetic ratio. Mathematica code to get \
this value:\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<2 IsotopeData[\\\"Fe57\\\",\\\"MagneticMoment\\\"]\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "0.1809"}], ";"}]}], "Input",
 CellChangeTimes->{{3.449924838011875*^9, 3.4499250161525*^9}, {
  3.44992505149625*^9, 3.449925053605625*^9}, {3.4499263461525*^9, 
  3.44992643618375*^9}, {3.449930606511875*^9, 3.44993060774625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]n", "::", "usage"}], "=", 
   RowBox[{
   "\"\<\[Mu]n = The Nuclear Magneton in eV/Tesla. Mathematica code to get \
this value:\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<Needs[\\\"Units`\\\"]\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<Needs[\\\"PhysicalConstants`\\\"]\\n\>\"", "<>", 
    "\[IndentingNewLine]", 
    "\"\<Convert[NuclearMagneton,ElectronVolt/Tesla]\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]n", "=", 
   RowBox[{"3.15245", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "8"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449924838011875*^9, 3.4499250161525*^9}, {
  3.44992505149625*^9, 3.449925053605625*^9}, {3.449925722730625*^9, 
  3.449925844715*^9}, {3.449925928355625*^9, 3.44992604393375*^9}, {
  3.4499261497775*^9, 3.44992623262125*^9}, {3.449926320855625*^9, 
  3.4499263259025*^9}, {3.4499306131525*^9, 3.4499306147775*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Begin the Private package definitions and code", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.436377537429641*^9, 3.436377556537116*^9}, 3.446235170296875*^9, {
   3.449843687538125*^9, 3.449843711975625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"clear", " ", "everything", " ", "first"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "definitions", " ", "may", " ", "be", " ", "read", 
     " ", "multiple", " ", "times"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "\"\<`*\>\"", "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<`*\>\"", "]"}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "set", " ", "plot", " ", "lines", " ", "to", " ", "be", " ", "thicker", 
    " ", "for", " ", "visibility"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"{", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Blue"}], "}"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4363775644084344`*^9, 3.436377567172409*^9}, {
   3.4363776567011447`*^9, 3.4363776601861563`*^9}, {3.4456220765446253`*^9, 
   3.4456220833258753`*^9}, 3.446235170296875*^9, {3.4500263985983567`*^9, 
   3.450026433876446*^9}, 3.450026489168366*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Managing dialog windows", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629409271875*^9}, 3.43637250653557*^9, 3.446235170296875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mosspecPaletteOpen", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"TrueQ", "[", 
     RowBox[{
      RowBox[{"Head", "[", "mosspecPaletteNotebook", "]"}], "===", 
      "NotebookObject"}], "]"}], ",", 
    RowBox[{"NotebookClose", "[", "mosspecPaletteNotebook", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"TrueQ", "[", 
     RowBox[{
      RowBox[{"Head", "[", "mosspecAskDialog", "]"}], "===", 
      "NotebookObject"}], "]"}], ",", 
    RowBox[{"NotebookClose", "[", "mosspecAskDialog", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mosspecHelpNotebook", " ", "=", " ", 
   RowBox[{"Notebook", "[", 
    RowBox[{"{", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mosspecAskDialog", "=", 
   RowBox[{"Notebook", "[", 
    RowBox[{"{", "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.436290529890625*^9, 3.43629055353125*^9}, {
   3.4362907869375*^9, 3.43629079834375*^9}, {3.4362978225*^9, 
   3.43629784584375*^9}, {3.436302042328125*^9, 3.43630208153125*^9}, {
   3.436368536536993*^9, 3.4363685635658584`*^9}, {3.436372542387122*^9, 
   3.4363725736721077`*^9}, {3.4364495059626846`*^9, 
   3.4364496369510365`*^9}, {3.4451863046701484`*^9, 3.445186364998273*^9}, {
   3.4457108512790003`*^9, 3.4457108750915003`*^9}, {3.4457188469977503`*^9, 
   3.4457188541852503`*^9}, {3.4458656183651247`*^9, 3.4458656256776247`*^9}, 
   3.446235170296875*^9, {3.449576915319375*^9, 3.44957700374125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Load an old MOSSPEC Data File", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629403325*^9}, {3.43629410959375*^9, 3.4362941175*^9}, {
   3.436294862296875*^9, 3.436294882625*^9}, {3.4457102029352503`*^9, 
   3.4457102110446253`*^9}, 3.446235170328125*^9, {3.449497974350625*^9, 
   3.449497984085*^9}, {3.4495005930225*^9, 3.449500605163125*^9}, 
   3.449854320475625*^9, {3.7020519022724032`*^9, 3.702051904730007*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LoadMosspecFile", "[", "name_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dList", ",", "data", ",", "i", ",", "digits"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"get", " ", "a", " ", "list", " ", "of", " ", "strings"}], ",",
        " ", 
       RowBox[{
       "one", " ", "for", " ", "each", " ", "data", " ", "line", " ", "in", 
        " ", "the", " ", "file"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dList", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"name", ",", "\"\<List\>\"", ",", 
         RowBox[{"\"\<IgnoreEmptyLines\>\"", "\[Rule]", "True"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"digits", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"dList", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringFreeQ", "[", 
            RowBox[{"#", ",", "digits"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "insert", " ", "commas", " ", "to", " ", "delimit", " ", "the", " ", 
         "numeric", " ", "fields"}], ",", " ", 
        RowBox[{"wrap", " ", "in", " ", 
         RowBox[{"{", " ", "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "61"}], ",", " ", 
        RowBox[{"i", ">", "0"}], ",", " ", 
        RowBox[{"i", "-=", "8"}], ",", 
        RowBox[{"dList", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringInsert", "[", 
             RowBox[{"#", ",", "\"\<,\>\"", ",", "i"}], "]"}], "&"}], ")"}], "/@",
           "dList"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dList", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\"\<{\>\"", "<>", "#", "<>", "\"\<}\>\""}], "&"}], ")"}], "/@",
         "dList"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "now", " ", "interpret", " ", "each", " ", "line", " ", "as", " ", "a",
         " ", "list", " ", "of", " ", "values", " ", "to", " ", "get", " ", 
        "data", " ", "array"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"1.0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ToExpression", "[", "#", "]"}], "&"}], ")"}], "/@", 
         "dList"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"drop", " ", "the", " ", "first", " ", "column", " ", 
        RowBox[{"(", 
         RowBox[{"X", " ", "indices"}], ")"}], " ", "and", " ", "flatten", 
        " ", "to", " ", "get", " ", "just", " ", 
        RowBox[{"Y", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"data", "//", "Transpose"}], "//", "Rest"}], "//", 
          "Transpose"}], "//", "Flatten"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "first", " ", "element", " ", "is", " ", "the", " ", 
        "acquisition", " ", 
        RowBox[{"time", ".", " ", "Build"}], " ", "a", " ", "header"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CurveFit`SaveForUndo", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveFit`DataFileName", " ", "=", " ", "name"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveFit`DataFileHeader", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<S Mosspec Data File for Experiment 29 \\n\>\"", "<>", 
        "\[IndentingNewLine]", "\"\<S Acquisition Time \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"First", "[", "data", "]"}], "/", "1000."}], "]"}], "<>", 
        "\"\< sec \\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Now", " ", "build", " ", "the", " ", "CurveFit", " ", "data", " ", 
        "structure"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CurveFit`yy", "=", 
       RowBox[{"Rest", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveFit`n", "=", 
       RowBox[{"Length", "[", "CurveFit`yy", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveFit`xx", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "CurveFit`n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CurveFit`sx", "=", 
       RowBox[{"CurveFit`sy", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "CurveFit`n"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Imported \>\"", "<>", 
        RowBox[{"ToString", "[", "CurveFit`n", "]"}], "<>", 
        "\"\< values from file:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "CurveFit`DataFileName", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<Comment Lines (generated automatically):\>\"", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "CurveFit`DataFileHeader", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadMosspecFile", "[", "]"}], ":=", 
  RowBox[{"LoadMosspecFile", "[", "CurveFit`DataFileName", "]"}]}]}], "Input",
 CellChangeTimes->{{3.449493749319375*^9, 3.449493827225625*^9}, {
   3.449493963631875*^9, 3.449493964663125*^9}, {3.44949400117875*^9, 
   3.4494940048975*^9}, {3.44949403886625*^9, 3.4494940393975*^9}, {
   3.449494137819375*^9, 3.449494276288125*^9}, {3.449494639256875*^9, 
   3.44949477496*^9}, {3.44949481974125*^9, 3.449494948506875*^9}, {
   3.449495011631875*^9, 3.449495351319375*^9}, {3.44949544199125*^9, 
   3.449495520756875*^9}, {3.449495558600625*^9, 3.449495613069375*^9}, {
   3.449495677975625*^9, 3.44949568296*^9}, {3.4494958490225*^9, 
   3.44949589121*^9}, {3.449496193038125*^9, 3.449496246100625*^9}, 
   3.449496401569375*^9, {3.4494972876475*^9, 3.4494972933975*^9}, 
   3.449498767913125*^9, {3.449498820006875*^9, 3.449498846913125*^9}, 
   3.44957457761625*^9, {3.449574661413125*^9, 3.449574709944375*^9}, {
   3.44957475780375*^9, 3.44957476499125*^9}, {3.45018652855875*^9, 
   3.450186550386875*^9}, {3.450186688636875*^9, 3.4501867247775*^9}, {
   3.4501867869025*^9, 3.4501868265275*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["6-line Spectrum Line Velocity Calculations", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629409271875*^9}, 3.43637250653557*^9, 3.446235170296875*^9, {
   3.4496045783975*^9, 3.4496045996475*^9}, {3.4497519879954014`*^9, 
   3.4497520146637487`*^9}, {3.449757744232464*^9, 3.4497577603656626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FeLineIz", "[", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "3"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"+", "1"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"+", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"+", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"+", "1"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"+", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"+", "3"}], "/", "2"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449604617600625*^9, 3.44960470424125*^9}, {
  3.449605132225625*^9, 3.44960522630375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FeLineQ", "[", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449604617600625*^9, 3.44960470424125*^9}, {
  3.449605132225625*^9, 3.44960522630375*^9}, {3.449751666863637*^9, 
  3.44975170260503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "natural", " ", "iron", " ", "line", " ", "velocities", " ", 
    "used", " ", "for", " ", "calibration"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FeLineV", "[", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "10.657"}], "/", "2"}], ",", 
      RowBox[{
       RowBox[{"-", "6.167"}], "/", "2"}], ",", 
      RowBox[{
       RowBox[{"-", "1.667"}], "/", "2"}], ",", 
      RowBox[{"1.667", "/", "2"}], ",", 
      RowBox[{"6.167", "/", "2"}], ",", 
      RowBox[{"10.657", "/", "2"}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.449604617600625*^9, 3.44960470424125*^9}, 
   3.449605295538125*^9, {3.4497520925156946`*^9, 3.4497521190037823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"General", " ", "line", " ", "velocity", " ", "calculators"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FeLineFunction", "[", 
      RowBox[{"vIso_", ",", "vB_", ",", "vQ_", ",", "gRatio_"}], "]"}], "[", 
     RowBox[{"Iz_", ",", "IzStar_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"vIso", "+", 
     RowBox[{"vB", 
      RowBox[{"(", 
       RowBox[{"Iz", "-", 
        RowBox[{"gRatio", " ", "IzStar"}]}], ")"}]}], "+", 
     RowBox[{"vQ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["IzStar", "2"], "-", 
        RowBox[{"5", "/", "4"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FeLineFunction", "[", "p__", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"Iz_", ",", "IzStar_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FeLineFunction", "[", "p", "]"}], "[", 
     RowBox[{"Iz", ",", "IzStar"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FeLineV", "[", 
     RowBox[{"vIso_", ",", "vB_", ",", "vQ_", ",", "gRatio_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FeLineFunction", "[", 
      RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], "]"}], "/@", 
     RowBox[{"FeLineIz", "[", "]"}]}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.4497521516306973`*^9, 3.4497522151520367`*^9}, {
   3.4497523280543823`*^9, 3.4497524194157534`*^9}, {3.449752450460394*^9, 
   3.4497524508409405`*^9}, {3.449752500802782*^9, 3.449752518738573*^9}, 
   3.449856449194375*^9, {3.450013580684445*^9, 3.450013663005193*^9}, {
   3.450013731249078*^9, 3.4500137709798927`*^9}, {3.4500140229260664`*^9, 
   3.4500140874515343`*^9}, {3.450014182927354*^9, 3.450014233266593*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Line Spectra", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629409271875*^9}, 3.43637250653557*^9, 3.446235170296875*^9, {
   3.4496045783975*^9, 3.4496045996475*^9}, {3.4497519879954014`*^9, 
   3.4497520146637487`*^9}, {3.449757744232464*^9, 3.4497577603656626`*^9}, {
   3.4497577922314835`*^9, 3.4497578005334206`*^9}, 3.449758142435051*^9, {
   3.449758760794208*^9, 3.4497587664823875`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"6", "-", 
    RowBox[{"line", " ", "spectrum", " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", "emission"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LineSpectrum", "[", 
     RowBox[{
      RowBox[{"v", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_"}], 
        "}"}]}], ",", "y1_", ",", "y2_", ",", "gam_"}], "]"}], "[", "x_", 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CurveFit`fLorentzianC", "[", 
          RowBox[{"#", ",", "gam", ",", "1", ",", "0"}], "]"}], "[", "x", 
         "]"}], "&"}], ")"}], "/@", "v"}], ")"}], ".", 
    RowBox[{"{", 
     RowBox[{"y1", ",", "y2", ",", "1", ",", "1", ",", "y2", ",", "y1"}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4497581523292785`*^9, 3.4497582328550687`*^9}, {
   3.449758264921178*^9, 3.449758296376408*^9}, {3.449758450167549*^9, 
   3.4497584512090464`*^9}, {3.4497586129215775`*^9, 3.449758703221422*^9}, {
   3.4497587517411904`*^9, 3.449758752382112*^9}, {3.4497588486905966`*^9, 
   3.4497588545990925`*^9}, {3.4497589726388254`*^9, 3.449758980470086*^9}, 
   3.4497590275577955`*^9, 3.449759792818186*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"2", "-", 
    RowBox[{"line", " ", "spectrum", " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", "emission"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LineSpectrum", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "y2_", ",", "gam_"}], "]"}], 
    "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CurveFit`fLorentzianC", "[", 
      RowBox[{"v1", ",", "gam", ",", "1", ",", "0"}], "]"}], "[", "x", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"CurveFit`fLorentzianC", "[", 
      RowBox[{"v2", ",", "gam", ",", "y2", ",", "0"}], "]"}], "[", "x", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4497581523292785`*^9, 3.4497582328550687`*^9}, {
   3.449758264921178*^9, 3.449758296376408*^9}, {3.449758450167549*^9, 
   3.4497584512090464`*^9}, {3.4497586129215775`*^9, 3.449758703221422*^9}, {
   3.4497587517411904`*^9, 3.449758752382112*^9}, {3.4497588486905966`*^9, 
   3.4497588545990925`*^9}, {3.4497589726388254`*^9, 3.449758980470086*^9}, 
   3.4497590275577955`*^9, {3.4497596754794607`*^9, 3.4497596911920547`*^9}, {
   3.449759775423173*^9, 3.4497598162518816`*^9}, {3.44986944896*^9, 
   3.4498694517725*^9}, {3.449869484569375*^9, 3.44986949661625*^9}, {
   3.449870233069375*^9, 3.449870235631875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"single", " ", "line", " ", "spectrum", " ", 
    RowBox[{"(", 
     RowBox[{"in", " ", "emission"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LineSpectrum", "[", 
      RowBox[{
       RowBox[{"{", "v_", "}"}], ",", "gam_"}], "]"}], "[", "x_", "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CurveFit`fLorentzianC", "[", 
      RowBox[{"v", ",", "gam", ",", "1", ",", "0"}], "]"}], "[", "x", "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LineSpectrum", "[", 
      RowBox[{"v_", ",", "gam_"}], "]"}], "[", "x_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CurveFit`fLorentzianC", "[", 
      RowBox[{"v", ",", "gam", ",", "1", ",", "0"}], "]"}], "[", "x", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4497581523292785`*^9, 3.4497582328550687`*^9}, {
   3.449758264921178*^9, 3.449758296376408*^9}, {3.449758450167549*^9, 
   3.4497584512090464`*^9}, {3.4497586129215775`*^9, 3.449758703221422*^9}, {
   3.4497587517411904`*^9, 3.449758752382112*^9}, {3.4497588486905966`*^9, 
   3.4497588545990925`*^9}, {3.4497589726388254`*^9, 3.449758980470086*^9}, 
   3.4497590275577955`*^9, {3.4497596754794607`*^9, 3.4497596911920547`*^9}, {
   3.449759775423173*^9, 3.4497598162518816`*^9}, {3.4497598555984592`*^9, 
   3.4497598866531134`*^9}, {3.4497599378667555`*^9, 3.4497600000661936`*^9}, 
   3.4497600452111087`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mossbauer", " ", "spectrum", " ", 
    RowBox[{"(", 
     RowBox[{"in", " ", "absorption"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MossSpectrum", "[", 
     RowBox[{
      RowBox[{"LineSpectrum", "[", "p__", "]"}], ",", "d_"}], "]"}], "[", 
    "x_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"d", " ", 
     RowBox[{
      RowBox[{"LineSpectrum", "[", "p", "]"}], "[", "x", 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.4497591039876957`*^9, 3.4497591968612413`*^9}, {
   3.4497592355668974`*^9, 3.4497593247851872`*^9}, 3.449759621431744*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Baseline Correction for 1/",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", "effect"}], TraditionalForm]], "None"]
}], "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629409271875*^9}, 3.43637250653557*^9, 3.446235170296875*^9, {
   3.4496045783975*^9, 3.4496045996475*^9}, {3.4497519879954014`*^9, 
   3.4497520146637487`*^9}, {3.449757744232464*^9, 3.4497577603656626`*^9}, {
   3.4497577922314835`*^9, 3.4497578005334206`*^9}, 3.449758142435051*^9, {
   3.449758760794208*^9, 3.4497587664823875`*^9}, {3.449760081262949*^9, 
   3.4497601026637216`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BaselineCorrection", "[", 
    RowBox[{"w_", ",", "h_"}], "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"h", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox["x", "2"], "/", 
      SuperscriptBox["w", "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.4497601109155874`*^9, 3.4497602063928766`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert X scale to velocity", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629403325*^9}, {3.4450072314375*^9, 3.445007253171875*^9}, 
   3.445007470109375*^9, 3.44597058340625*^9, 3.4462351703125*^9, {
   3.4495748386475*^9, 3.449574860194375*^9}, {3.4498492503975*^9, 
   3.449849258413125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChanToVelocity", "[", "x_", "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "<", "511"}], "&&", 
      RowBox[{"CalLowerQ", "[", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Last", "[", 
       RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"First", "[", 
         RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", ">=", "511"}], "&&", 
      RowBox[{"CalUpperQ", "[", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Last", "[", 
       RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"First", "[", 
         RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", "True", ",", "x"}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChanToVelocity", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"CurveFit`CheckLength", "[", "]"}]}], ",", " ", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", "CurveFit`xx", "]"}], "<", "511"}], "&&", 
       RowBox[{"CalLowerQ", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CurveFit`SaveForUndo", "[", "]"}], ";", 
       RowBox[{"CurveFit`xx", "=", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"CurveFit`xx", "-", 
           RowBox[{"First", "[", 
            RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], 
            "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CurveFit`sx", "*=", 
        RowBox[{"Abs", "[", 
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}], 
         "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", "CurveFit`xx", "]"}], ">=", "511"}], "&&", 
       RowBox[{"CalUpperQ", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CurveFit`SaveForUndo", "[", "]"}], ";", 
       RowBox[{"CurveFit`xx", "=", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"CurveFit`xx", "-", 
           RowBox[{"First", "[", 
            RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], 
            "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CurveFit`sx", "*=", 
        RowBox[{"Abs", "[", 
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xx", ",", "sx", ",", "yy", ",", "sy"}], "}"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xx", ",", "sx", ",", "yy", ",", "sy"}], "}"}], "//", 
            "Transpose"}], "//", "Sort"}], "//", "Transpose"}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.449849441819375*^9, 3.449849509694375*^9}, {
   3.449849606600625*^9, 3.44984961524125*^9}, {3.44984965599125*^9, 
   3.44984995374125*^9}, {3.4498500176475*^9, 3.449850300631875*^9}, 
   3.4498505823975*^9, {3.44985073896*^9, 3.449850765038125*^9}, {
   3.4498690566475*^9, 3.449869114600625*^9}, {3.4510623932225676`*^9, 
   3.4510624044422507`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VelocitySigma", "[", 
   RowBox[{"v_", ",", "\"\<Lower\>\""}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CalLowerQ", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["v", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"VelocityParameters", "[", "\"\<SigmaLower\>\"", "]"}], 
           "]"}], "/", 
          RowBox[{"Last", "[", 
           RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}]}],
          ")"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "]"}], 
         RowBox[{"First", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<SigmaLower\>\"", "]"}], 
          "]"}]}], ")"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VelocitySigma", "[", 
   RowBox[{"v_", ",", "\"\<Upper\>\""}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CalUpperQ", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["v", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"VelocityParameters", "[", "\"\<SigmaLower\>\"", "]"}], 
           "]"}], "/", 
          RowBox[{"Last", "[", 
           RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}]}],
          ")"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "]"}], 
         RowBox[{"First", "[", 
          RowBox[{"VelocityParameters", "[", "\"\<SigmaUpper\>\"", "]"}], 
          "]"}]}], ")"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.44985034396*^9, 3.44985055742875*^9}, {
  3.449850588038125*^9, 3.449850617850625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
M\[ODoubleDot]ssbauer spectra fitting functions\
\>", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629403325*^9}, {3.4450072314375*^9, 3.445007253171875*^9}, 
   3.445007470109375*^9, 3.44597058340625*^9, 3.4462351703125*^9, {
   3.4495748386475*^9, 3.449574860194375*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Nonlinear Regression function (depends on ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " version)"
}], "Subsubsection",
 CellChangeTimes->{{3.445007328171875*^9, 3.445007346734375*^9}, {
   3.4452696750290003`*^9, 3.4452697050602503`*^9}, 3.4462351703125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"TrueQ", "[", 
     RowBox[{"$VersionNumber", "\[GreaterEqual]", " ", "7.0"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Version", " ", "7", " ", "nonlinear", " ", "fits"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NonlinFit", "[", "p__", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "model", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"model", "=", 
         RowBox[{"NonlinearModelFit", "[", "p", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"model", "[", "\"\<EstimatedVariance\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"model", "[", "\"\<BestFitParameters\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"model", "[", "\"\<ParameterErrors\>\"", "]"}], "/", 
           RowBox[{"Sqrt", "@", 
            RowBox[{"model", "[", "\"\<EstimatedVariance\>\"", "]"}]}]}], ",", 
          RowBox[{"model", "[", "\"\<CorrelationMatrix\>\"", "]"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Version", " ", "6", " ", "nonlinear", " ", "fits"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NonlinFit", "[", "p__", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "model", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"model", "=", 
         RowBox[{"NonlinearRegress", "[", 
          RowBox[{"p", ",", 
           RowBox[{"RegressionReport", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "BestFitParameters", ",", "AsymptoticCovarianceMatrix", ",", 
              "EstimatedVariance", ",", "AsymptoticCorrelationMatrix"}], 
             "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EstimatedVariance", "/.", "model"}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{"BestFitParameters", "/.", "model"}], ")"}], ",", 
          RowBox[{"Sqrt", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Diagonal", "@", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{"AsymptoticCovarianceMatrix", "/.", "model"}], 
                ")"}]}]}], "/", 
             RowBox[{"(", 
              RowBox[{"EstimatedVariance", "/.", "model"}], ")"}]}], ")"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{"AsymptoticCorrelationMatrix", "/.", "model"}], ")"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4452692083258753`*^9, 3.4452692911227503`*^9}, {
   3.4452693528727503`*^9, 3.4452694731071253`*^9}, 3.4452695826852503`*^9, {
   3.4452697525133753`*^9, 3.4452698510602503`*^9}, {3.4452699119040003`*^9, 
   3.4452699136227503`*^9}, 3.4452760395290003`*^9, {3.4452765255133753`*^9, 
   3.4452765621852503`*^9}, {3.4452766255290003`*^9, 
   3.4452766482633753`*^9}, {3.4456282253415003`*^9, 
   3.4456282930290003`*^9}, {3.4456868407165003`*^9, 
   3.4456868492321253`*^9}, {3.4456884017321253`*^9, 3.4456884492790003`*^9}, 
   3.4462351703125*^9, {3.449843961538125*^9, 3.44984405867875*^9}, {
   3.449844127506875*^9, 3.4498441421475*^9}, {3.449844403850625*^9, 
   3.449844448819375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Velocity calibration using Natural Fe spectrum", "Subsubsection",
 CellChangeTimes->{{3.445007328171875*^9, 3.445007346734375*^9}, {
   3.4452696750290003`*^9, 3.4452697050602503`*^9}, 3.4462351703125*^9, {
   3.4497744505750046`*^9, 3.449774470313387*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalLowerQ", "[", "]"}], "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalUpperQ", "[", "]"}], "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VelocityParameters", "[", "\"\<SigmaLower\>\"", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VelocityParameters", "[", "\"\<SigmaUpper\>\"", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449843432319375*^9, 3.449843539006875*^9}, {
  3.44984619961625*^9, 3.44984621405375*^9}, {3.449849486381875*^9, 
  3.449849489319375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Calibrate", "::", "uncal"}], "=", 
   "\"\<Calibrate only uncalibrated (raw) channel numbers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Calibrate", "::", "range"}], "=", 
    "\"\<Limit the data to either the lower half or upper half of the full \
spectrum, then Calibrate.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Calibrate", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "lowerQ", ",", "data", ",", "wts", ",", "results", ",", "f", ",", "init",
       ",", "x", ",", "c", ",", "m", ",", "s", ",", "d", ",", "y1", ",", "y2",
       ",", "g", ",", "h", ",", "sc", ",", "sm", ",", "ss", ",", "sd", ",", 
      "sy1", ",", "sy2", ",", "sg", ",", "sh", ",", "sigs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"data", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CurveFit`CheckLength", "[", "]"}]}], ",", " ", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", "CurveFit`xx", "]"}], "<", "0"}], "||", 
        RowBox[{
         RowBox[{"Max", "[", "CurveFit`xx", "]"}], "<", "50"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"Calibrate", "::", "uncal"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Min", "[", "CurveFit`xx", "]"}], "<", 
          RowBox[{"511", "-", "50"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "[", "CurveFit`xx", "]"}], ">", 
          RowBox[{"511", "+", "50"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"Calibrate", "::", "range"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"fitting", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"lowerQ", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Mean", "[", "CurveFit`xx", "]"}], "<", "511"}], ")"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MossSpectrum", "[", 
           RowBox[{
            RowBox[{"LineSpectrum", "[", 
             RowBox[{
              RowBox[{"FeLineV", "[", "]"}], ",", "y1", ",", "y2", ",", "g"}],
              "]"}], ",", "d"}], "]"}], "[", 
          RowBox[{"s", 
           RowBox[{"(", 
            RowBox[{"x", "-", "m"}], ")"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"BaselineCorrection", "[", 
           RowBox[{"9.0", ",", "h"}], "]"}], "[", 
          RowBox[{"s", 
           RowBox[{"(", 
            RowBox[{"x", "-", "m"}], ")"}]}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "CurveFit`sy", "]"}], ">", "0.0"}], ",", 
       RowBox[{"wts", "=", 
        RowBox[{"1", "/", 
         SuperscriptBox["CurveFit`sy", "2"]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"init", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", 
          RowBox[{"1.0", 
           RowBox[{"Last", "[", "CurveFit`yy", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"If", "[", 
           RowBox[{"lowerQ", ",", "256", ",", "768"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"s", ",", 
          RowBox[{"If", "[", 
           RowBox[{"lowerQ", ",", 
            RowBox[{"9.0", "/", "256"}], ",", 
            RowBox[{
             RowBox[{"-", "9.0"}], "/", "256"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"d", ",", ".1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y1", ",", "2.0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y2", ",", "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"g", ",", ".3"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"h", ",", 
          RowBox[{"If", "[", 
           RowBox[{"lowerQ", ",", 
            RowBox[{"-", ".01"}], ",", ".01"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "beginning", " ", "info"}], ",", " ", 
       RowBox[{"then", " ", "fit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`funct", "=", 
      RowBox[{"\"\<Fit to \>\"", "<>", 
       RowBox[{"If", "[", 
        RowBox[{"lowerQ", ",", "\"\<lower\>\"", ",", "\"\<upper\>\""}], "]"}],
        "<>", "\"\< half of a Natural Fe M\[ODoubleDot]ssbauer spectrum to \
determine channel velocity calibration of the MS-900 spectrometer.\>\""}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<n = \>\"", ",", "CurveFit`n"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`funct", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"results", "=", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Fit of (x,y)  (unweighted)\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Fit of (x,y\[PlusMinus]\\!\\(\[Sigma]\\_y\\))  \>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x", ",", 
           RowBox[{"Weights", "\[Rule]", "wts"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"results", ",", 
        RowBox[{"3", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "sc", ",", "sm", ",", "ss", ",", "sd", ",", "sy1", ",", "sy2", 
              ",", "sg", ",", "sh"}], "}"}], ",", 
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
              ")"}]}]}], " ", "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
       " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
       "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`fY", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
      RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "the", " ", "appropriate", " ",
        "velocity", " ", "calibration", " ", "results"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"lowerQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CalLowerQ", "[", "]"}], "=", "True"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VelocityParameters", "[", "\"\<Lower\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "s"}], "}"}], "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VelocityParameters", "[", "\"\<SigmaLower\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"sm", ",", "ss"}], "}"}], "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CalUpperQ", "[", "]"}], "=", "True"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VelocityParameters", "[", "\"\<Upper\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "s"}], "}"}], "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VelocityParameters", "[", "\"\<SigmaUpper\>\"", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"sm", ",", "ss"}], "}"}], "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Std. Deviation =\>\"", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"results", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) =\>\"", ",", 
              RowBox[{"results", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Velocity Calibration:\>\"", ",", "Bold"}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<0-velocity channel =\>\"", ",", 
            RowBox[{"m", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sm", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<slope (mm/s/channel) =\>\"", ",", 
            RowBox[{"s", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"ss", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fe Spectrum Parameters:\>\"", ",", "Bold"}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<Line width (mm/s) =\>\"", ",", 
            RowBox[{"g", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sg", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<Inner line depth =\>\"", ",", 
            RowBox[{"d", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sd", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<Depth outer/inner =\>\"", ",", 
            RowBox[{"y1", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sy1", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<Depth middle/inner =\>\"", ",", 
            RowBox[{"y2", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sy2", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<Baseline counts =\>\"", ",", 
            RowBox[{"c", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sc", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<1/\!\(\*SuperscriptBox[\(r\), \(2\)]\) correction factor \
=\>\"", ",", 
            RowBox[{"h", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"", 
            ",", 
            RowBox[{"sh", "/.", 
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Alignment", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
            "}"}], ",", "Baseline"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.4497729542634144`*^9, 3.4497731529991827`*^9}, 
   3.449773202480333*^9, {3.4497732559872723`*^9, 3.44977356162676*^9}, {
   3.4497736678194575`*^9, 3.44977371509744*^9}, {3.449773851653798*^9, 
   3.4497739747808466`*^9}, {3.4497740512708335`*^9, 
   3.4497742508778543`*^9}, {3.44977436778596*^9, 3.4497743925615854`*^9}, {
   3.449776065196717*^9, 3.4497761115533743`*^9}, {3.4497761951035137`*^9, 
   3.4497762410495806`*^9}, {3.449776274207259*^9, 3.4497763812712097`*^9}, {
   3.4497764115747843`*^9, 3.449776495415341*^9}, {3.4497765664875374`*^9, 
   3.4497765789254227`*^9}, {3.4497766382407136`*^9, 
   3.4497766849578896`*^9}, {3.449776722271544*^9, 3.449776763651045*^9}, {
   3.449778918860083*^9, 3.4497789312579107`*^9}, {3.4497789959208913`*^9, 
   3.449779227503891*^9}, {3.449779324903946*^9, 3.449779352083027*^9}, {
   3.449779515067387*^9, 3.4497795818233776`*^9}, {3.4497796265677166`*^9, 
   3.449779755583232*^9}, {3.4497801913498335`*^9, 3.4497801972282867`*^9}, 
   3.4497802790759773`*^9, {3.449847604475625*^9, 3.449847718569375*^9}, {
   3.44984775105375*^9, 3.449847820288125*^9}, {3.449847886381875*^9, 
   3.449847908975625*^9}, {3.449847960725625*^9, 3.4498479997725*^9}, {
   3.44984828749125*^9, 3.449848365288125*^9}, {3.449848520131875*^9, 
   3.449848542819375*^9}, {3.449848710350625*^9, 3.4498487585225*^9}, {
   3.44984887146*^9, 3.44984912174125*^9}, {3.449850872069375*^9, 
   3.44985087899125*^9}, {3.449851853850625*^9, 3.449852085381875*^9}, {
   3.4498522045225*^9, 3.44985220811625*^9}, {3.44985225217875*^9, 
   3.449852331335*^9}, {3.4498523715225*^9, 3.449852868256875*^9}, {
   3.449852900225625*^9, 3.449852941788125*^9}, {3.4498529728975*^9, 
   3.449853098163125*^9}, {3.44985317846*^9, 3.449853181913125*^9}, 
   3.44985332724125*^9, {3.4498533672725*^9, 3.449853387085*^9}, {
   3.4498534268975*^9, 3.44985346092875*^9}, {3.44985363967875*^9, 
   3.449853646225625*^9}, {3.449853687585*^9, 3.449853689881875*^9}, {
   3.44985374542875*^9, 3.449853753725625*^9}, {3.449853802444375*^9, 
   3.4498538063975*^9}, {3.44985390221*^9, 3.449853909756875*^9}, {
   3.44985402242875*^9, 3.449854039350625*^9}, {3.449868690569375*^9, 
   3.449868707835*^9}, 3.4500435223139343`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fit a Fe spectrum", "Subsubsection",
 CellChangeTimes->{{3.445007328171875*^9, 3.445007346734375*^9}, {
   3.4452696750290003`*^9, 3.4452697050602503`*^9}, 3.4462351703125*^9, {
   3.4497744505750046`*^9, 3.449774470313387*^9}, {3.44985495836625*^9, 
   3.449854964444375*^9}, 3.449869284819375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FitLines", "::", "uncal"}], "=", 
   "\"\<Perform a velocity calibration and then transform X from channels to \
velocity using ChanToVelocity[].\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.449869295631875*^9, 3.449869296725625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitLines", "[", 
   RowBox[{"6", ",", 
    RowBox[{"pInit_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "wts", ",", "results", ",", "f", ",", "init", ",", "thr", 
      ",", "peaks", ",", "x", ",", "c", ",", "p1", ",", "p2", ",", "p3", ",", 
      "p4", ",", "p5", ",", "p6", ",", "y1", ",", "y2", ",", "g", ",", "d", 
      ",", "h", ",", "sc", ",", "sp1", ",", "sp2", ",", "sp3", ",", "sp4", 
      ",", "sp5", ",", "sp6", ",", "sy1", ",", "sy2", ",", "sg", ",", "sd", 
      ",", "sh", ",", "sigs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"data", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CurveFit`CheckLength", "[", "]"}]}], ",", " ", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "CurveFit`xx", "]"}], ">", "50"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FitLines", "::", "uncal"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"identify", " ", "peaks"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "pInit", "]"}], "===", "List"}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", "pInit", "]"}], "\[Equal]", "6"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"peaks", "=", "pInit"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thr", "=", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "CurveFit`yy", "]"}], "+", 
            RowBox[{"Min", "[", "CurveFit`yy", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"peaks", "=", 
         RowBox[{"Mean", "/@", "\[IndentingNewLine]", 
          RowBox[{"FindClusters", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "#", "]"}], "<", "thr"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "6", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Agglomerate\>\""}]}], 
           "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"fitting", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MossSpectrum", "[", 
           RowBox[{
            RowBox[{"LineSpectrum", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], 
               "}"}], ",", "y1", ",", "y2", ",", "g"}], "]"}], ",", "d"}], 
           "]"}], "[", "x", "]"}], "+", 
         RowBox[{
          RowBox[{"BaselineCorrection", "[", 
           RowBox[{"9.0", ",", "h"}], "]"}], "[", "x", "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "CurveFit`sy", "]"}], ">", "0.0"}], ",", 
       RowBox[{"wts", "=", 
        RowBox[{"1", "/", 
         SuperscriptBox["CurveFit`sy", "2"]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"init", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"1.0", 
            RowBox[{"Last", "[", "CurveFit`yy", "]"}]}]}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], 
            "}"}], ",", "peaks"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", ".1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y1", ",", "2.0"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y2", ",", "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"g", ",", ".3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"h", ",", "0."}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "beginning", " ", "info"}], ",", " ", 
       RowBox[{"then", " ", "fit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "CurveFit`Private`funct", "=", 
      "\"\<Fit 6-line Fe M\[ODoubleDot]ssbauer spectrum.\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<n = \>\"", ",", "CurveFit`n"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`funct", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"results", "=", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Fit of (x,y)  (unweighted)\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Fit of (x,y\[PlusMinus]\\!\\(\[Sigma]\\_y\\))  \>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x", ",", 
           RowBox[{"Weights", "\[Rule]", "wts"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"results", ",", 
        RowBox[{"3", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "sc", ",", "sp1", ",", "sp2", ",", "sp3", ",", "sp4", ",", "sp5",
               ",", "sp6", ",", "sd", ",", "sy1", ",", "sy2", ",", "sg", ",", 
              "sh"}], "}"}], ",", 
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
              ")"}]}]}], " ", "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OtherParamsList", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g", ",", "d", ",", "y1", ",", "y2", ",", "c", ",", "h"}], 
        "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "PeakList", " ", "and", " ", 
       "PeakSigmaList"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}],
         "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakSigmaList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sp1", ",", "sp2", ",", "sp3", ",", "sp4", ",", "sp5", ",", "sp6"}], 
        "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
       " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
       "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`fY", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
      RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Std. Deviation = \>\"", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"results", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) = \>\"", ",", 
              RowBox[{"results", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Peak Positions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p1", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp1", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\"\<  \>\"", ",", 
               RowBox[{"p2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p3", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp3", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\"\<  \>\"", ",", 
               RowBox[{"p4", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp4", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p5", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp5", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\"\<  \>\"", ",", 
               RowBox[{"p6", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sp6", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "Right", ",", "Center", ",", "Left", ",", "Center", ",", 
                "Right", ",", "Center", ",", "Left"}], "}"}], ",", 
              "Baseline"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", ",",
          "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Other Parameters:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Line width (mm/s) =\>\"", ",", 
               RowBox[{"g", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sg", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Inner line depth =\>\"", ",", 
               RowBox[{"d", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sd", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Depth outer/inner =\>\"", ",", 
               RowBox[{"y1", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sy1", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Depth middle/inner =\>\"", ",", 
               RowBox[{"y2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sy2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Baseline counts =\>\"", ",", 
               RowBox[{"c", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sc", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<1/\!\(\*SuperscriptBox[\(r\), \(2\)]\) correction factor =\
\>\"", ",", 
               RowBox[{"h", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sh", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
               "}"}], ",", "Baseline"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<Use PeakList[] to return a list of peak positions.\>\"", ",", 
         "\[IndentingNewLine]", 
         "\"\<Use PeakSigmaList[] to get their uncertainties.\>\""}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.4498550173975*^9, 3.449855072163125*^9}, {
   3.44985510442875*^9, 3.44985524480375*^9}, {3.449855319413125*^9, 
   3.4498554196475*^9}, {3.449855467569375*^9, 3.449855499444375*^9}, 
   3.44985554292875*^9, {3.449855589006875*^9, 3.44985561967875*^9}, {
   3.449855653631875*^9, 3.44985574530375*^9}, {3.44985577699125*^9, 
   3.449855905881875*^9}, {3.449857819538125*^9, 3.449857823475625*^9}, {
   3.4498578567725*^9, 3.449857859085*^9}, {3.449857890381875*^9, 
   3.449857969163125*^9}, {3.449858005163125*^9, 3.449858114131875*^9}, {
   3.44985817974125*^9, 3.449858214819375*^9}, 3.449858313835*^9, {
   3.449858389506875*^9, 3.44985842705375*^9}, {3.449858461975625*^9, 
   3.449858486913125*^9}, {3.449858601975625*^9, 3.4498586102725*^9}, {
   3.44985892761625*^9, 3.44985895711625*^9}, {3.44985927955375*^9, 
   3.449859402913125*^9}, {3.44985944642875*^9, 3.449859447225625*^9}, {
   3.449859528288125*^9, 3.44985956699125*^9}, {3.44985960417875*^9, 
   3.44985962099125*^9}, {3.44985965480375*^9, 3.4498596612725*^9}, {
   3.449859694585*^9, 3.449859876335*^9}, {3.4498599525225*^9, 
   3.44985998124125*^9}, {3.44986003911625*^9, 3.4498600461475*^9}, {
   3.44986014911625*^9, 3.449860281006875*^9}, 3.449869290819375*^9, 
   3.449870771819375*^9, {3.4500194117244368`*^9, 3.450019414333578*^9}, {
   3.450021563047286*^9, 3.4500216452117987`*^9}, {3.4500217058001194`*^9, 
   3.4500217406876183`*^9}, {3.450024449226161*^9, 3.450024469021262*^9}, {
   3.450043355985089*^9, 3.4500434060274796`*^9}, {3.452018008707375*^9, 
   3.452018017863625*^9}, {3.45201806131675*^9, 3.452018082269875*^9}, {
   3.452018132894875*^9, 3.4520181369105*^9}, 3.452018655144875*^9, {
   3.452018685769875*^9, 3.452018750301125*^9}, {3.452019134863625*^9, 
   3.452019192832375*^9}, {3.45202034894175*^9, 3.4520203616605*^9}, {
   3.452020457613625*^9, 3.452020582973*^9}, {3.45202072500425*^9, 
   3.45202085281675*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitLines", "[", 
   RowBox[{"2", ",", 
    RowBox[{"pInit_List:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "wts", ",", "results", ",", "f", ",", "init", ",", "thr", 
      ",", "peaks", ",", "x", ",", "c", ",", "p1", ",", "p2", ",", "y2", ",", 
      "g", ",", "d", ",", "h", ",", "sc", ",", "sp1", ",", "sp2", ",", "sy2", 
      ",", "sg", ",", "sd", ",", "sh", ",", "sigs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"data", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CurveFit`CheckLength", "[", "]"}]}], ",", " ", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "CurveFit`xx", "]"}], ">", "50"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FitLines", "::", "uncal"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"identify", " ", "peaks"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "pInit", "]"}], "===", "List"}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", "pInit", "]"}], "\[Equal]", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"peaks", "=", "pInit"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thr", "=", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "CurveFit`yy", "]"}], "+", 
            RowBox[{"Min", "[", "CurveFit`yy", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"peaks", "=", 
         RowBox[{"Mean", "/@", "\[IndentingNewLine]", 
          RowBox[{"FindClusters", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "#", "]"}], "<", "thr"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "2", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Agglomerate\>\""}]}], 
           "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"fitting", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MossSpectrum", "[", 
           RowBox[{
            RowBox[{"LineSpectrum", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p1", ",", "p2"}], "}"}], ",", "y2", ",", "g"}], "]"}],
             ",", "d"}], "]"}], "[", "x", "]"}], "+", 
         RowBox[{
          RowBox[{"BaselineCorrection", "[", 
           RowBox[{"9.0", ",", "h"}], "]"}], "[", "x", "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "CurveFit`sy", "]"}], ">", "0.0"}], ",", 
       RowBox[{"wts", "=", 
        RowBox[{"1", "/", 
         SuperscriptBox["CurveFit`sy", "2"]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"init", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"1.0", 
            RowBox[{"Last", "[", "CurveFit`yy", "]"}]}]}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2"}], "}"}], ",", "peaks"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", ".1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y2", ",", "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"g", ",", ".3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"h", ",", "0."}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "beginning", " ", "info"}], ",", " ", 
       RowBox[{"then", " ", "fit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "CurveFit`Private`funct", "=", 
      "\"\<Fit 2-line Fe M\[ODoubleDot]ssbauer spectrum.\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<n = \>\"", ",", "CurveFit`n"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`funct", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"results", "=", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Fit of (x,y)  (unweighted)\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Fit of (x,y\[PlusMinus]\\!\\(\[Sigma]\\_y\\))  \>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x", ",", 
           RowBox[{"Weights", "\[Rule]", "wts"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"results", ",", 
        RowBox[{"3", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "sc", ",", "sp1", ",", "sp2", ",", "sd", ",", "sy2", ",", "sg", 
              ",", "sh"}], "}"}], ",", 
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
              ")"}]}]}], " ", "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "OtherParamsList", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "PeakList", " ", "and", " ", 
       "PeakSigmaList"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakSigmaList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sp1", ",", "sp2"}], "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
       " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
       "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`fY", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
      RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Std. Deviation = \>\"", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"results", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) = \>\"", ",", 
              RowBox[{"results", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Peak Positions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p1", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"",
               ",", 
              RowBox[{"sp1", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", "\"\<  \>\"", ",", 
              RowBox[{"p2", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"",
               ",", 
              RowBox[{"sp2", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "Right", ",", "Center", ",", "Left", ",", "Center", ",", 
                "Right", ",", "Center", ",", "Left"}], "}"}], ",", 
              "Baseline"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", ",",
          "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Other Parameters:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Line width (mm/s) =\>\"", ",", 
               RowBox[{"g", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sg", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Lower line depth =\>\"", ",", 
               RowBox[{"d", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sd", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Depth upper/lower =\>\"", ",", 
               RowBox[{"y2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sy2", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Baseline counts =\>\"", ",", 
               RowBox[{"c", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sc", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<1/\!\(\*SuperscriptBox[\(r\), \(2\)]\) correction factor =\
\>\"", ",", 
               RowBox[{"h", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sh", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
               "}"}], ",", "Baseline"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<Use PeakList[] to return a list of peak positions.\>\"", ",", 
         "\[IndentingNewLine]", 
         "\"\<Use PeakSigmaList[] to get their uncertainties.\>\""}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.4498550173975*^9, 3.449855072163125*^9}, {
   3.44985510442875*^9, 3.44985524480375*^9}, {3.449855319413125*^9, 
   3.4498554196475*^9}, {3.449855467569375*^9, 3.449855499444375*^9}, 
   3.44985554292875*^9, {3.449855589006875*^9, 3.44985561967875*^9}, {
   3.449855653631875*^9, 3.44985574530375*^9}, {3.44985577699125*^9, 
   3.449855905881875*^9}, {3.449857819538125*^9, 3.449857823475625*^9}, {
   3.4498578567725*^9, 3.449857859085*^9}, {3.449857890381875*^9, 
   3.449857969163125*^9}, {3.449858005163125*^9, 3.449858114131875*^9}, {
   3.44985817974125*^9, 3.449858214819375*^9}, 3.449858313835*^9, {
   3.449858389506875*^9, 3.44985842705375*^9}, {3.449858461975625*^9, 
   3.449858486913125*^9}, {3.449858601975625*^9, 3.4498586102725*^9}, {
   3.44985892761625*^9, 3.44985895711625*^9}, {3.44985927955375*^9, 
   3.449859402913125*^9}, {3.44985944642875*^9, 3.449859447225625*^9}, {
   3.449859528288125*^9, 3.44985956699125*^9}, {3.44985960417875*^9, 
   3.44985962099125*^9}, {3.44985965480375*^9, 3.4498596612725*^9}, {
   3.449859694585*^9, 3.449859876335*^9}, {3.4498599525225*^9, 
   3.44985998124125*^9}, {3.44986003911625*^9, 3.4498600461475*^9}, {
   3.44986014911625*^9, 3.449860281006875*^9}, {3.449869290819375*^9, 
   3.44986939046*^9}, {3.449870802100625*^9, 3.44987094074125*^9}, {
   3.4500193962570724`*^9, 3.4500193978506804`*^9}, {3.4500245558103604`*^9, 
   3.450024565122026*^9}, 3.4500245996033115`*^9, 3.4500434463051205`*^9, {
   3.452021025301125*^9, 3.452021062926125*^9}, {3.6070815098537035`*^9, 
   3.6070815100877037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitLines", "[", "1", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "wts", ",", "results", ",", "f", ",", "init", ",", "peak", 
      ",", "x", ",", "c", ",", "p1", ",", "g", ",", "d", ",", "h", ",", "sc", 
      ",", "sp1", ",", "sg", ",", "sd", ",", "sh", ",", "sigs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"data", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CurveFit`CheckLength", "[", "]"}]}], ",", " ", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "CurveFit`xx", "]"}], ">", "50"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FitLines", "::", "uncal"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"identify", " ", "peaks"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"peak", "=", "\[IndentingNewLine]", 
      RowBox[{"Mean", "[", 
       RowBox[{
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], "\[LessEqual]", 
            RowBox[{"Min", "[", "CurveFit`yy", "]"}]}], "&"}]}], 
         "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"fitting", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MossSpectrum", "[", 
           RowBox[{
            RowBox[{"LineSpectrum", "[", 
             RowBox[{
              RowBox[{"{", "p1", "}"}], ",", "g"}], "]"}], ",", "d"}], "]"}], 
          "[", "x", "]"}], "+", 
         RowBox[{
          RowBox[{"BaselineCorrection", "[", 
           RowBox[{"9.0", ",", "h"}], "]"}], "[", "x", "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"CurveFit`xx", ",", "CurveFit`yy"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "CurveFit`sy", "]"}], ">", "0.0"}], ",", 
       RowBox[{"wts", "=", 
        RowBox[{"1", "/", 
         SuperscriptBox["CurveFit`sy", "2"]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"init", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"1.0", 
            RowBox[{"Last", "[", "CurveFit`yy", "]"}]}]}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "peak"}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", ".1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"g", ",", ".3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"h", ",", "0."}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "beginning", " ", "info"}], ",", " ", 
       RowBox[{"then", " ", "fit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "CurveFit`Private`funct", "=", 
      "\"\<Fit single line Fe M\[ODoubleDot]ssbauer spectrum.\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<n = \>\"", ",", "CurveFit`n"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`funct", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"results", "=", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Fit of (x,y)  (unweighted)\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Fit of (x,y\[PlusMinus]\\!\\(\[Sigma]\\_y\\))  \>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"NonlinFit", "[", 
          RowBox[{"data", ",", "f", ",", "init", ",", "x", ",", 
           RowBox[{"Weights", "\[Rule]", "wts"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"results", ",", 
        RowBox[{"3", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"sc", ",", "sp1", ",", "sd", ",", "sg", ",", "sh"}], 
             "}"}], ",", 
            RowBox[{
             RowBox[{"results", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
              ")"}]}]}], " ", "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "OtherParamsList", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "PeakList", " ", "and", " ", 
       "PeakSigmaList"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", "p1", "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PeakSigmaList", "[", "]"}], "=", 
      RowBox[{
       RowBox[{"{", "sp1", "}"}], "/.", 
       RowBox[{"results", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
       " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
       "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`fY", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"f", "/.", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
      RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "wts", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Std. Deviation = \>\"", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"results", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) = \>\"", ",", 
              RowBox[{"results", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Peak Position:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p1", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\"\<\[PlusMinus]\>\"",
               ",", 
              RowBox[{"sp1", "/.", 
               RowBox[{"results", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Right", ",", "Center", ",", "Left"}], "}"}], ",", 
              "Baseline"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", ",",
          "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Other Parameters:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Line width (mm/s) =\>\"", ",", 
               RowBox[{"g", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sg", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Line depth =\>\"", ",", 
               RowBox[{"d", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sd", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Baseline counts =\>\"", ",", 
               RowBox[{"c", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sc", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<1/\!\(\*SuperscriptBox[\(r\), \(2\)]\) correction factor =\
\>\"", ",", 
               RowBox[{"h", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sh", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
               "}"}], ",", "Baseline"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<Use PeakList[] to return a list of peak positions.\>\"", ",", 
         "\[IndentingNewLine]", 
         "\"\<Use PeakSigmaList[] to get their uncertainties.\>\""}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.4498550173975*^9, 3.449855072163125*^9}, {
   3.44985510442875*^9, 3.44985524480375*^9}, {3.449855319413125*^9, 
   3.4498554196475*^9}, {3.449855467569375*^9, 3.449855499444375*^9}, 
   3.44985554292875*^9, {3.449855589006875*^9, 3.44985561967875*^9}, {
   3.449855653631875*^9, 3.44985574530375*^9}, {3.44985577699125*^9, 
   3.449855905881875*^9}, {3.449857819538125*^9, 3.449857823475625*^9}, {
   3.4498578567725*^9, 3.449857859085*^9}, {3.449857890381875*^9, 
   3.449857969163125*^9}, {3.449858005163125*^9, 3.449858114131875*^9}, {
   3.44985817974125*^9, 3.449858214819375*^9}, 3.449858313835*^9, {
   3.449858389506875*^9, 3.44985842705375*^9}, {3.449858461975625*^9, 
   3.449858486913125*^9}, {3.449858601975625*^9, 3.4498586102725*^9}, {
   3.44985892761625*^9, 3.44985895711625*^9}, {3.44985927955375*^9, 
   3.449859402913125*^9}, {3.44985944642875*^9, 3.449859447225625*^9}, {
   3.449859528288125*^9, 3.44985956699125*^9}, {3.44985960417875*^9, 
   3.44985962099125*^9}, {3.44985965480375*^9, 3.4498596612725*^9}, {
   3.449859694585*^9, 3.449859876335*^9}, {3.4498599525225*^9, 
   3.44985998124125*^9}, {3.44986003911625*^9, 3.4498600461475*^9}, {
   3.44986014911625*^9, 3.449860281006875*^9}, {3.449869290819375*^9, 
   3.44986939046*^9}, {3.449870802100625*^9, 3.44987094074125*^9}, {
   3.44993094799625*^9, 3.449931074715*^9}, {3.44993119605875*^9, 
   3.449931341543125*^9}, {3.449931753230625*^9, 3.449931777761875*^9}, {
   3.44993212684*^9, 3.449932153011875*^9}, {3.4499322206525*^9, 
   3.449932226949375*^9}, {3.44993227459*^9, 3.449932333715*^9}, {
   3.450019383164496*^9, 3.4500193850080805`*^9}, {3.4500246542702875`*^9, 
   3.4500246593479576`*^9}, 3.450043486160924*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fit peaks to theory", "Subsubsection",
 CellChangeTimes->{{3.445007328171875*^9, 3.445007346734375*^9}, {
   3.4452696750290003`*^9, 3.4452697050602503`*^9}, 3.4462351703125*^9, {
   3.4497744505750046`*^9, 3.449774470313387*^9}, {3.44985495836625*^9, 
   3.449854964444375*^9}, 3.449869284819375*^9, {3.450014971559811*^9, 
   3.4500149774499083`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ModelPeaks", "[", 
    RowBox[{"peaks", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "vIso", ",", "vB", ",", "vQ", ",", "gRatio", ",", "svIso", 
       ",", "svB", ",", "svQ", ",", "sgRatio", ",", "I1", ",", "I2", ",", 
       "results"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FeLineIz", "[", "]"}], ",", "peaks"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"NonlinFit", "[", 
        RowBox[{"data", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FeLineFunction", "[", 
           RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], "]"}], "[", 
          RowBox[{"I1", ",", "I2"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vIso", ",", "0.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vB", ",", "4.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vQ", ",", "0.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gRatio", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "1.75"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"I1", ",", "I2"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"results", ",", 
         RowBox[{"3", "->", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"svIso", ",", "svB", ",", "svQ", ",", "sgRatio"}], 
              "}"}], ",", 
             RowBox[{
              RowBox[{"results", "[", 
               RowBox[{"[", "3", "]"}], "]"}], 
              RowBox[{"Sqrt", "[", 
               RowBox[{"results", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], " ", "]"}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
        " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "OtherParamsList", "]"}], "===", "List"}], " ",
          "&&", " ", 
         RowBox[{
          RowBox[{"Length", "[", "OtherParamsList", "]"}], "\[Equal]", 
          "6"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Clear", "[", 
          RowBox[{
          "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
           "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"CurveFit`fY", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "g", ",", "d", ",", "y1", ",", "y2", ",", "c", ",", "h"}], 
                "}"}], "=", "OtherParamsList"}], ";", "\[IndentingNewLine]", 
              RowBox[{"c", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MossSpectrum", "[", 
                   RowBox[{
                    RowBox[{"LineSpectrum", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FeLineV", "[", 
                    RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], 
                    "]"}], "/.", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", "y1", ",", 
                    "y2", ",", "g"}], "]"}], ",", "d"}], "]"}], "[", "x", 
                  "]"}], "+", 
                 RowBox[{
                  RowBox[{"BaselineCorrection", "[", 
                   RowBox[{"9.0", ",", "h"}], "]"}], "[", "x", "]"}]}], 
                ")"}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
          RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
       RowBox[{"Column", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Std. Deviation = \>\"", ",", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"results", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Model Parameters:\>\"", ",", "Bold"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<Iso shift (\!\(\*SubscriptBox[\(v\), \(iso\)]\),mm/s) =\>\
\"", ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"vIso", "/.", 
                  RowBox[{"results", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\"\<\[PlusMinus]\>\"", ",", 
                RowBox[{"svIso", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Hyperfine (\!\(\*SubscriptBox[\(v\), \(B\)]\),mm/s) \
=\>\"", ",", 
                RowBox[{"vB", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\"\<\[PlusMinus]\>\"", ",", 
                RowBox[{"svB", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SuperscriptBox[\(g\), \(*\)]\)/g =\>\"", ",", 
                RowBox[{"gRatio", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\"\<\[PlusMinus]\>\"", ",", 
                RowBox[{"sgRatio", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<-1/(\!\(\*SuperscriptBox[\(g\), \(*\)]\)/g) =\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "gRatio"}], "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\"\<\[PlusMinus]\>\"", ",", 
                RowBox[{
                 RowBox[{"sgRatio", "/", 
                  RowBox[{"gRatio", "^", "2"}]}], "/.", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"results", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"results", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Quadrupole (\!\(\*SubscriptBox[\(v\), \(Q\)]\),mm/s) \
=\>\"", ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"vQ", "/.", 
                  RowBox[{"results", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\"\<\[PlusMinus]\>\"", ",", 
                RowBox[{"svQ", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"Alignment", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
                "}"}], ",", "Baseline"}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Peak Positions:\>\"", ",", "Bold"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{"peaks", ",", "\"\<Data:\>\""}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FeLineV", "[", 
                   RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], 
                   "]"}], "/.", 
                  RowBox[{"results", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", 
                "\"\<Model:\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
            ",", 
            RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "OtherParamsList", "]"}], "===", "List"}], " ",
          "&&", " ", 
         RowBox[{
          RowBox[{"Length", "[", "OtherParamsList", "]"}], "\[Equal]", 
          "6"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Plot Fit Results to see modeled spectrum v. counts data.\>\"", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelPeaks", "[", 
   RowBox[{
    RowBox[{"peaks", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_"}], 
      "}"}]}], ",", 
    RowBox[{"sigs", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_"}], 
      "}"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "vIso", ",", "vB", ",", "vQ", ",", "gRatio", ",", "svIso", 
      ",", "svB", ",", "svQ", ",", "sgRatio", ",", "I1", ",", "I2", ",", 
      "results", ",", "g", ",", "d", ",", "y1", ",", "y2", ",", "c", ",", 
      "h"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Flatten", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FeLineIz", "[", "]"}], ",", "peaks"}], "}"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"NonlinFit", "[", 
       RowBox[{"data", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FeLineFunction", "[", 
          RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], "]"}], "[", 
         RowBox[{"I1", ",", "I2"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vIso", ",", "0.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"vB", ",", "4.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"vQ", ",", "0.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"gRatio", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "1.75"}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"I1", ",", "I2"}], "}"}], ",", 
        RowBox[{"Weights", "\[Rule]", 
         RowBox[{"1", "/", 
          RowBox[{"sigs", "^", "2"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"results", ",", 
        RowBox[{"3", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"svIso", ",", "svB", ",", "svQ", ",", "sgRatio"}], "}"}],
             ",", 
            RowBox[{"results", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], "]"}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "values", " ", "to", " ", "CurveFit", " ", "functions", 
       " ", "resulting", " ", "from", " ", "the", " ", "fit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "OtherParamsList", "]"}], "===", "List"}], " ", 
        "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "OtherParamsList", "]"}], "\[Equal]", "6"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Clear", "[", 
         RowBox[{
         "CurveFit`fY", ",", "CurveFit`Private`yff", ",", 
          "CurveFit`Private`ssy"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CurveFit`fY", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "g", ",", "d", ",", "y1", ",", "y2", ",", "c", ",", "h"}], 
               "}"}], "=", "OtherParamsList"}], ";", "\[IndentingNewLine]", 
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"MossSpectrum", "[", 
                  RowBox[{
                   RowBox[{"LineSpectrum", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FeLineV", "[", 
                    RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], 
                    "]"}], "/.", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", "y1", ",", 
                    "y2", ",", "g"}], "]"}], ",", "d"}], "]"}], "[", "x", 
                 "]"}], "+", 
                RowBox[{
                 RowBox[{"BaselineCorrection", "[", 
                  RowBox[{"9.0", ",", "h"}], "]"}], "[", "x", "]"}]}], 
               ")"}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CurveFit`Private`yff", "[", "x_", "]"}], ":=", 
         RowBox[{"fY", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CurveFit`Private`ssy", "=", "CurveFit`sy"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CurveFit`Private`results", "=", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) = \>\"", ",", 
            RowBox[{"results", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Model Parameters:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<Iso shift (\!\(\*SubscriptBox[\(v\), \(iso\)]\),mm/s) \
=\>\"", ",", 
               RowBox[{"Chop", "[", 
                RowBox[{"vIso", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"svIso", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Hyperfine (\!\(\*SubscriptBox[\(v\), \(B\)]\),mm/s) =\>\"",
                ",", 
               RowBox[{"vB", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"svB", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<\!\(\*SuperscriptBox[\(g\), \(*\)]\)/g =\>\"", ",", 
               RowBox[{"gRatio", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"sgRatio", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<-1/(\!\(\*SuperscriptBox[\(g\), \(*\)]\)/g) =\>\"", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "gRatio"}], "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{
                RowBox[{"sgRatio", "/", 
                 RowBox[{"gRatio", "^", "2"}]}], "/.", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"results", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"results", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Quadrupole (\!\(\*SubscriptBox[\(v\), \(Q\)]\),mm/s) \
=\>\"", ",", 
               RowBox[{"Chop", "[", 
                RowBox[{"vQ", "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
               "\"\<\[PlusMinus]\>\"", ",", 
               RowBox[{"svQ", "/.", 
                RowBox[{"results", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Right", ",", "Right", ",", "Center", ",", "Left"}], 
               "}"}], ",", "Baseline"}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Peak Positions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"peaks", ",", "\"\<Data:\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FeLineV", "[", 
                  RowBox[{"vIso", ",", "vB", ",", "vQ", ",", "gRatio"}], 
                  "]"}], "/.", 
                 RowBox[{"results", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", 
               "\"\<Model:\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "CurveFit`Private`results", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "OtherParamsList", "]"}], "===", "List"}], " ", 
        "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "OtherParamsList", "]"}], "\[Equal]", "6"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Plot Fit Results to see modeled spectrum v. counts data.\>\"", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.450014439591855*^9, 3.45001481896411*^9}, {
   3.4500148972695932`*^9, 3.4500149349693403`*^9}, {3.450014991761126*^9, 
   3.4500149956826496`*^9}, {3.4500158045476685`*^9, 
   3.4500158118595133`*^9}, {3.4500158906024575`*^9, 
   3.4500159576277018`*^9}, {3.450018768953909*^9, 3.450018979216318*^9}, {
   3.450019011135333*^9, 3.4500190981744084`*^9}, 3.450019188681923*^9, {
   3.450019228600221*^9, 3.450019233287301*^9}, {3.4500193568074827`*^9, 
   3.4500193797429276`*^9}, {3.450019462063676*^9, 3.4500194960293827`*^9}, {
   3.450019550102662*^9, 3.450019561789115*^9}, {3.450019632579646*^9, 
   3.4500196438755093`*^9}, {3.4500196974488335`*^9, 
   3.4500197004798117`*^9}, {3.450019759177677*^9, 3.45001977320767*^9}, {
   3.4500198495758266`*^9, 3.4500198904159174`*^9}, 3.4500199414894657`*^9, {
   3.4500219280927*^9, 3.450021987962335*^9}, {3.450022057659215*^9, 
   3.4500221113575277`*^9}, {3.4500221503540335`*^9, 
   3.4500222736711082`*^9}, {3.450022456248498*^9, 3.450022507993861*^9}, {
   3.450023003121369*^9, 3.450023072412035*^9}, {3.450023118111065*^9, 
   3.450023278127976*^9}, {3.4500242596181517`*^9, 3.450024319753388*^9}, 
   3.450024609305567*^9, {3.4500246737685404`*^9, 3.450024788586377*^9}, {
   3.450024829645198*^9, 3.4500248336448393`*^9}, {3.4500248700322037`*^9, 
   3.450024907325737*^9}, 3.450024937947993*^9, {3.450025012691295*^9, 
   3.4500250238621693`*^9}, {3.4500425513071947`*^9, 3.450042561899995*^9}, {
   3.4500431380046215`*^9, 3.450043151378423*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choice Manager", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629403325*^9}, {3.43629410959375*^9, 3.4362941175*^9}, {
   3.436294862296875*^9, 3.4362949086875*^9}, {3.436295582015625*^9, 
   3.4362955865625*^9}, 3.446235170328125*^9}],

Cell[BoxData[
 RowBox[{"mosspecPalette", ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", "mosspecPaletteOpen"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mosspecPaletteOpen", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookClose", "[", "mosspecAskDialog", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookClose", "[", "mosspecHelpNotebook", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mosspecAskDialog", "=", "mosspecAsk"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mosspecPaletteNotebook", "=", 
      RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Grid", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Data Management\>\"", ",", "Bold"}], "]"}], ",", 
              "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Load Mosspec Data File\>\"", ",", 
                  "\"\<Load a MOSSPEC program data file\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", "fileloader"}], "]"}], ",", 
              "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Set to Poisson count data\>\"", ",", 
                  "\"\<Set \[Sigma]y = \\!\\(\\*SqrtBox[\\\"Y\\\"]\\)\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "eval", "[", "\"\<MakePoisson[Xerrors -> False]\>\"", "]"}]}],
                "]"}], ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Keep an X-range\>\"", ",", 
                  "\"\<Opens a dialog to remove all but a subset of the \
data\>\""}], "]"}], ",", "\[IndentingNewLine]", "subsetX"}], "]"}], ",", 
              "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Rebin Data\>\"", ",", 
                  "\"\<Merge data in adjacent bins to reduce noise.\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "rebinner"}], "]"}], ",", 
              "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Undo\>\"", ",", "\"\<Undo last data operation\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<Undo[]\>\"", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{"\"\<Redo\>\"", ",", "\"\<Redo last Undo\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<Redo[]\>\"", "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Velocity Calibration\>\"", ",", "Bold"}], "]"}], 
              ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Calibrate\>\"", ",", 
                  "\"\<Calibrate velocities using a Natural Iron \
spectrum\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<Calibrate[]\>\"", "]"}]}], "]"}], 
              ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Convert to Velocity\>\"", ",", 
                  "\"\<Use calibration results to convert X scale to velocity\
\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<ChanToVelocity[]\>\"", "]"}]}], 
               "]"}], ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Fit Lines\>\"", ",", "Bold"}], "]"}], ",", 
              "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Fit 6 Lines\>\"", ",", 
                  "\"\<Fit a 6-line spectrum. Calibrate velocity \
first.\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<FitLines[6]\>\"", "]"}]}], "]"}], 
              ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Fit 2 Lines\>\"", ",", 
                  "\"\<Fit a 2-line spectrum. Calibrate velocity \
first.\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<FitLines[2]\>\"", "]"}]}], "]"}], 
              ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Fit 1 Line\>\"", ",", 
                  "\"\<Fit a single line spectrum. Calibrate velocity \
first.\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"eval", "[", "\"\<FitLines[1]\>\"", "]"}]}], "]"}], 
              ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Plot Fit Results\>\"", ",", 
                  "\"\<Linear plot of fit results.\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "eval", "[", "\"\<LinearDifferencePlot[]\>\"", "]"}]}], "]"}],
               ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Fit Model to Lines\>\"", ",", "Bold"}], "]"}], 
              ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Model 6 Lines\>\"", ",", 
                  "\"\<Once you've fit a 6-line spectrum, calculate model \
parameters from line positions.\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "eval", "[", "\"\<ModelPeaks[PeakList[],PeakSigmaList[]]\>\"",
                  "]"}]}], "]"}], ",", "SpanFromLeft"}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Legacy MOSSPEC data\>\"", ",", "Bold"}], "]"}], 
              ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Load Old Mosspec File\>\"", ",", 
                  "\"\<Load an old-format MOSSPEC program data file\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "oldfileloader"}], "]"}], 
              ",", "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Application Control\>\"", ",", "Bold"}], "]"}], 
              ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Help\>\"", ",", 
                  "\"\<Opens a notebook with information\>\""}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Quiet", "[", 
                  RowBox[{"NotebookClose", "[", "mosspecHelpNotebook", "]"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mosspecHelpNotebook", "=", "\[IndentingNewLine]", 
                  RowBox[{"CreateDocument", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Cell", "[", 
                    RowBox[{
                    RowBox[{"BoxData", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Print\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Style\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"\\<Click on a symbol name for its description\\>\
\\\"\>\"", ",", "\"\<,\>\"", ",", "\"\<\\\"\\<Subsubsection\\>\\\"\>\""}], 
                    "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}], ",", "\"\<;\>\""}], "}"}], 
                    "]"}], ",", "\"\<\[IndentingNewLine]\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Information\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"\\<Mosspec`*\\>\\\"\>\"", ",", "\"\<,\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<LongForm\>\"", ",", "\"\<\[Rule]\>\"", ",", 
                    "\"\<False\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                    "\"\<Input\>\""}], "]"}], "\n", "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "WindowTitle", "\[Rule]", "\"\<Mosspec Help\>\""}], ",", 
                    RowBox[{"Saveable", "\[Rule]", "False"}]}], 
                   "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                 "SetSelectedNotebook", "[", "mosspecHelpNotebook", "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"SelectionMove", "[", 
                  RowBox[{
                  "mosspecHelpNotebook", ",", "All", ",", "CellContents"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                 "SelectionEvaluate", "[", "mosspecHelpNotebook", "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", "70"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                 "\"\<Quit\>\"", ",", 
                  "\"\<Quit the M\[ODoubleDot]ssbauer spectrum \
application\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mosspecPaletteOpen", "=", "False"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SetOptions", "[", 
                  RowBox[{"mosspecAskDialog", ",", 
                   RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
                 RowBox[{"NotebookClose", "[", "mosspecHelpNotebook", "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                 "NotebookClose", "[", "mosspecPaletteNotebook", "]"}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", "70"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}],
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dividers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"False", ",", 
             RowBox[{"{", 
              RowBox[{
              "False", ",", "False", ",", "False", ",", "False", ",", "False",
                ",", "False", ",", "True", ",", "False", ",", "False", ",", 
               "True", ",", "False", ",", "False", ",", "False", ",", "False",
                ",", "True", ",", "False", ",", "True", ",", "False", ",", 
               "True"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"WindowTitle", "\[Rule]", "\"\<Mosspec\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Saveable", "\[Rule]", "False"}], ",", 
        RowBox[{"WindowFrameElements", "\[Rule]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WindowMargins", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"50", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "10"}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.44957736861625*^9, 3.4495774496475*^9}, {
   3.4495774806475*^9, 3.449577483085*^9}, {3.449577514944375*^9, 
   3.44957767846*^9}, {3.4495777158975*^9, 3.44957774530375*^9}, {
   3.449577832194375*^9, 3.449577833835*^9}, {3.449579729038125*^9, 
   3.4495797650225*^9}, {3.44957984274125*^9, 3.449579906225625*^9}, 
   3.449579948069375*^9, {3.44958109049125*^9, 3.44958112742875*^9}, {
   3.44958125496*^9, 3.4495812745225*^9}, {3.449581474006875*^9, 
   3.449581592085*^9}, {3.449581643038125*^9, 3.449581655381875*^9}, {
   3.449581822944375*^9, 3.4495818311475*^9}, 3.449582171975625*^9, {
   3.449582288256875*^9, 3.449582313288125*^9}, {3.449582368256875*^9, 
   3.449582370069375*^9}, 3.449587840225625*^9, 3.449587870585*^9, {
   3.44958792124125*^9, 3.449587992350625*^9}, {3.449604239694375*^9, 
   3.449604241038125*^9}, {3.4496043031475*^9, 3.449604308663125*^9}, {
   3.449671063377421*^9, 3.449671157973443*^9}, {3.4497514225122766`*^9, 
   3.4497514463365345`*^9}, {3.4497515052412353`*^9, 
   3.4497515686424017`*^9}, {3.449860717069375*^9, 3.4498607821475*^9}, {
   3.4498608347725*^9, 3.4498609327725*^9}, {3.449861087413125*^9, 
   3.449861170381875*^9}, {3.44986121305375*^9, 3.449861216381875*^9}, {
   3.449861276475625*^9, 3.449861299788125*^9}, {3.449861348069375*^9, 
   3.449861350350625*^9}, {3.4498613888975*^9, 3.449861439475625*^9}, {
   3.4498711056475*^9, 3.4498711233975*^9}, {3.4499313945275*^9, 
   3.44993142043375*^9}, {3.4500202136213303`*^9, 3.450020396698675*^9}, {
   3.45002576190541*^9, 3.450025860537196*^9}, {3.4500259576222467`*^9, 
   3.450025961824995*^9}, {3.4500260374275956`*^9, 3.4500260689560204`*^9}, {
   3.450026538882661*^9, 3.4500266165007057`*^9}, {3.450030587473*^9, 
   3.4500305889728656`*^9}, {3.450030968891947*^9, 3.4500309706730375`*^9}, {
   3.7020520362382383`*^9, 3.7020521103383684`*^9}, {3.7020521523336425`*^9, 
   3.7020521530356436`*^9}, {3.7020524969226475`*^9, 3.702052497811849*^9}, 
   3.7020537492520475`*^9}],

Cell[BoxData[
 RowBox[{"mosspecAsk", ":=", 
  RowBox[{"CreateDialog", "[", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "TextCell", "[", 
          "\"\<Are you sure you want to end the\\nM\[ODoubleDot]ssbauer \
spectrum application?\>\"", "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DefaultButton", "[", 
          RowBox[{"ImageSize", "\[Rule]", "80"}], "]"}], ",", 
         RowBox[{"CancelButton", "[", 
          RowBox[{
           RowBox[{"mosspecPalette", ";", 
            RowBox[{"SetOptions", "[", 
             RowBox[{"mosspecAskDialog", ",", 
              RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "80"}]}], "]"}]}], "}"}]}], "}"}], 
     "]"}], ",", 
    RowBox[{"WindowFloating", "\[Rule]", "True"}], ",", 
    RowBox[{"Visible", "\[Rule]", "False"}], ",", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<Quit Mosspec\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.44957706896*^9, 3.449577107663125*^9}, {
  3.44957723796*^9, 3.44957724392875*^9}}],

Cell[BoxData[
 RowBox[{"fileloader", ":=", 
  RowBox[{"eval", "[", "\n", "\t\t", 
   RowBox[{
   "\"\<With[\>\"", "<>", "\n", "\t\t", 
    "\"\<  {name = SystemDialogInput[\\\"FileOpen\\\",\>\"", "<>", "\n", 
    "\t\t\t", "\"\<{DataFileName,{\\\"data files\\\"->\>\"", "<>", "\n", 
    "\t\t\t", "\"\<{\\\"*.dat\\\"},\\\"all files\\\"->{\\\"*\\\"}}}]\>\"", "<>",
     "\n", "\t\t\t", "\"\<},\\n\>\"", "<>", "\n", "\t\t", 
    "\"\<  If[ name =!= $Canceled, \\n\>\"", "<>", "\n", "\t\t", 
    "\"\<    LoadFile[name]]\\n\>\"", "<>", "\n", "\t\t", "\"\<]\>\""}], "\n",
    "\t\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.4495799230225*^9, 3.4495799280225*^9}, {
   3.44958036874125*^9, 3.449580470725625*^9}, 3.449580551006875*^9, 
   3.449580605256875*^9, {3.449604043319375*^9, 3.449604107194375*^9}, {
   3.70205224788381*^9, 3.7020522493190126`*^9}, 3.7020522982874985`*^9, {
   3.702052348129586*^9, 3.7020524638817897`*^9}, {3.7020533900162163`*^9, 
   3.7020533998910336`*^9}}],

Cell[BoxData[
 RowBox[{"oldfileloader", ":=", 
  RowBox[{"eval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "\"\<With[\>\"", "<>", 
    "\"\<  {name = \
SystemDialogInput[\\\"FileOpen\\\",CurveFit`DataFileName]},\\n\>\"", "<>", 
    "\"\<  If[ name =!= $Canceled, \\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<    LoadMosspecFile[name]]\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<]\>\""}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.4495799230225*^9, 3.4495799280225*^9}, {
   3.44958036874125*^9, 3.449580470725625*^9}, 3.449580551006875*^9, 
   3.449580605256875*^9, {3.449604043319375*^9, 3.449604107194375*^9}, {
   3.702052173502879*^9, 3.70205217389288*^9}}],

Cell[BoxData[
 RowBox[{"subsetX", ":=", 
  RowBox[{"CurveFit`Palette`Private`XReval", "[", 
   RowBox[{"\"\<XRangeKeep\>\"", ",", 
    RowBox[{"SymbolName", "[", "CurveFit`Palette`Private`plotfcn", "]"}], ",", 
    RowBox[{"SymbolName", "[", 
     RowBox[{
      RowBox[{
      "CurveFit`plotLogs", "[", "CurveFit`Palette`Private`plotfcn", "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    "\"\<\\\"Set the X values for the range you wish to keep.\\\"\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4495880008975*^9, 3.449588006538125*^9}, {
   3.449588110944375*^9, 3.449588140194375*^9}, 3.449588179381875*^9, {
   3.44958822849125*^9, 3.449588268850625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rebinner", " ", ":=", " ", 
   RowBox[{"insert", "[", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<(* change the arguments of the following function \\n\>\"", "<>", 
     "\"\<   to perform the data rebinning you want, \\n\>\"", "<>", 
     "\"\<   then evaluate this cell.      *)\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", "\"\<Rebin[ \\n\>\"", "<>", 
     "\"\<  3,   (* change to the number of channels you want to combine \
*)\\n\>\"", "<>", 
     "\"\<  Averaging -> True,   (* change to False to make Y values the \
total of the binned channel Y's *)\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<  Xerrors -> False \\n\>\"", "<>", "\"\<]\\n\\n\>\"", "<>", 
     "\[IndentingNewLine]", 
     "\"\<(* Use Undo[] if you don't like the results. *)\>\""}], 
    "\[IndentingNewLine]", "]"}]}], "\n"}]], "Input",
 CellChangeTimes->{{3.450030782611764*^9, 3.4500308773064036`*^9}, {
  3.4500309382853146`*^9, 3.4500309509091835`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"insert", "[", 
   RowBox[{"command_String", ",", " ", "nb_NotebookObject"}], "]"}], ":=", 
  RowBox[{"(", "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", "After", ",", "Notebook"}], "]"}], ";", "\n", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb", ",", "command", ",", "None"}], "]"}], ";", "\n", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", " ", "All", ",", " ", "Cell"}], "]"}], ";", "\n", 
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"NotebookSelection", "[", "nb", "]"}], ",", " ", "\n", "\t", 
      RowBox[{"GeneratedCell", " ", "->", " ", "False"}]}], "]"}], ";"}], 
   "\n", ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"insert", "[", "command_String", "]"}], ":=", " ", 
   RowBox[{"insert", "[", 
    RowBox[{"command", ",", " ", 
     RowBox[{"InputNotebook", "[", "]"}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"eval", "[", 
   RowBox[{"command_String", ",", " ", "nb_NotebookObject"}], "]"}], ":=", 
  RowBox[{"(", "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", "After", ",", "Notebook"}], "]"}], ";", "\n", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb", ",", "command", ",", "None"}], "]"}], ";", "\n", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", " ", "All", ",", " ", "Cell"}], "]"}], ";", "\n", 
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"NotebookSelection", "[", "nb", "]"}], ",", " ", "\n", "\t", 
      RowBox[{"GeneratedCell", " ", "->", " ", "False"}]}], "]"}], ";", "\n", 
    RowBox[{"SelectionEvaluateCreateCell", "[", "nb", "]"}], ";"}], "\n", 
   ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eval", "[", "command_String", "]"}], ":=", " ", 
   RowBox[{"eval", "[", 
    RowBox[{"command", ",", " ", 
     RowBox[{"InputNotebook", "[", "]"}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"TextHint", "[", 
   RowBox[{"s_String", ",", " ", "nb_NotebookObject"}], "]"}], ":=", 
  RowBox[{"(", "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", "After", ",", "Notebook"}], "]"}], ";", "\n", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{"s", ",", "\"\<Text\>\""}], "]"}], ",", "None"}], "]"}], ";", 
    "\n", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", " ", "All", ",", " ", "Cell"}], "]"}], ";", "\n", 
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"NotebookSelection", "[", "nb", "]"}], ",", " ", "\n", "\t", 
      RowBox[{"GeneratedCell", " ", "->", " ", "False"}]}], "]"}], ";"}], 
   "\n", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TextHint", "[", "s_String", "]"}], ":=", 
  RowBox[{"TextHint", "[", 
   RowBox[{"s", ",", 
    RowBox[{"InputNotebook", "[", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.449580273725625*^9, 3.449580293288125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.436377671151924*^9, 3.4363776806956472`*^9}, 
   3.446235170328125*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Start the appication", "Subsection",
 CellChangeTimes->{{3.436292760578125*^9, 3.4362927961875*^9}, {
   3.4362928378125*^9, 3.436292860421875*^9}, {3.436294025390625*^9, 
   3.43629403325*^9}, {3.43629410959375*^9, 3.4362941175*^9}, {
   3.436294862296875*^9, 3.4362949086875*^9}, {3.436295582015625*^9, 
   3.4362955865625*^9}, {3.436450153944437*^9, 3.436450172931739*^9}, 
   3.446235170328125*^9}],

Cell[BoxData[
 RowBox[{"mosspecPalette", ";"}]], "Input",
 CellChangeTimes->{3.436387246190153*^9, 3.446235170328125*^9, 
  3.449574903444375*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\

Some Useful Constant Definitions\
\>", "Subsubtitle",
 CellFrame->{{0, 0}, {0, 2}},
 CellMargins->{{27., 37.75}, {8., 2.}},
 CellChangeTimes->{{3.4458752524588747`*^9, 3.4458752667088747`*^9}, 
   3.4458754209276247`*^9, {3.4458815470682497`*^9, 3.4458815500369997`*^9}, {
   3.4458815809588747`*^9, 3.4458815834901247`*^9}, {3.4458827533026247`*^9, 
   3.4458827836463747`*^9}, {3.4458874155526247`*^9, 3.4458874441307497`*^9}, 
   3.446235170296875*^9, {3.44957545199125*^9, 3.44957545971*^9}, {
   3.4495755007725*^9, 3.449575503256875*^9}, {3.449924564386875*^9, 
   3.449924582449375*^9}},
 TextAlignment->Center,
 FontWeight->"Bold",
 CellTags->"Package Initialization and Definitions"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E0 = \"\>", "\[InvisibleSpace]", "14412.9`"}],
  SequenceForm["E0 = ", 14412.9],
  Editable->False]], "Print",
 CellChangeTimes->{3.449930730824375*^9}],

Cell[BoxData[
 StyleBox["\<\"E0 = The iron M\[ODoubleDot]ssbauer \[Gamma] energy in eV. \
Mathematica code to get this value:\\n\\n\!\(\*SuperscriptBox[\(10\), \
\(3\)]\)(IsotopeData[\\\"Fe57\\\",\\\"ExcitedStateEnergies\\\"]//First)\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.449930730918125*^9},
 CellTags->"Info3449905530-2707848"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Mu]n = \"\>", "\[InvisibleSpace]", "3.15245`*^-8"}],
  SequenceForm["\[Mu]n = ", 3.15245*^-8],
  Editable->False]], "Print",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{
  3.449930730824375*^9, {3.44993076499625*^9, 3.449930794715*^9}}],

Cell[BoxData[
 StyleBox["\<\"\[Mu]n = The Nuclear Magneton in eV/Tesla. Mathematica code to \
get this value:\\n\\nNeeds[\\\"Units`\\\"]\\nNeeds[\\\"PhysicalConstants`\\\"]\
\\nConvert[NuclearMagneton,ElectronVolt/Tesla]\"\>", "MSG"]], "Print", \
"PrintUsage",
 CellChangeTimes->{3.449930794793125*^9},
 CellTags->"Info3449905594-8189583"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"g = \"\>", "\[InvisibleSpace]", "0.1809`"}],
  SequenceForm["g = ", 0.1809],
  Editable->False]], "Print",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{
  3.449930730824375*^9, {3.44993076499625*^9, 3.44993081749625*^9}}],

Cell[BoxData[
 StyleBox["\<\"g = The iron ground state gyromagnetic ratio. Mathematica code \
to get this value:\\n\\n2 \
IsotopeData[\\\"Fe57\\\",\\\"MagneticMoment\\\"]\"\>", "MSG"]], "Print", \
"PrintUsage",
 CellChangeTimes->{3.449930817574375*^9},
 CellTags->"Info3449905617-5386397"]
}, Open  ]]
}, Open  ]],

Cell["\<\

User Area\
\>", "Subsubtitle",
 CellFrame->{{0, 0}, {0, 2}},
 CellMargins->{{27., 37.75}, {8., 2.}},
 CellChangeTimes->{{3.4458752524588747`*^9, 3.4458752667088747`*^9}, 
   3.4458754209276247`*^9, {3.4458815470682497`*^9, 3.4458815500369997`*^9}, {
   3.4458815809588747`*^9, 3.4458815834901247`*^9}, {3.4458827533026247`*^9, 
   3.4458827836463747`*^9}, {3.4458874155526247`*^9, 3.4458874441307497`*^9}, 
   3.446235170296875*^9, {3.44957545199125*^9, 3.44957545971*^9}, {
   3.4495755007725*^9, 3.449575503256875*^9}},
 TextAlignment->Center,
 FontWeight->"Bold",
 CellTags->"Package Initialization and Definitions"]
}, Open  ]]
},
AutoGeneratedPackage->None,
InitializationCellEvaluation->True,
WindowSize->{679, 851},
WindowMargins->{{Automatic, 594}, {Automatic, 37}},
ShowSelection->True,
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Package Initialization and Definitions"->{
  Cell[897, 30, 542, 12, 49, "Subsubtitle",
   CellTags->"Package Initialization and Definitions"],
  Cell[186355, 4407, 703, 15, 59, "Subsubtitle",
   CellTags->"Package Initialization and Definitions"],
  Cell[188877, 4477, 630, 14, 59, "Subsubtitle",
   CellTags->"Package Initialization and Definitions"]},
 "init"->{
  Cell[2615, 68, 437, 11, 36, "Subsection",
   InitializationCell->True,
   CellTags->"init"]},
 "package"->{
  Cell[7482, 187, 519, 9, 33, "Section",
   CellTags->"package"]},
 "Info3449905530-2707848"->{
  Cell[187287, 4433, 353, 6, 77, "Print",
   CellTags->"Info3449905530-2707848"]},
 "Info3449905594-8189583"->{
  Cell[187940, 4450, 339, 6, 109, "Print",
   CellTags->"Info3449905594-8189583"]},
 "Info3449905617-5386397"->{
  Cell[188561, 4467, 289, 6, 75, "Print",
   CellTags->"Info3449905617-5386397"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Package Initialization and Definitions", 189934, 4507},
 {"init", 190256, 4514},
 {"package", 190366, 4518},
 {"Info3449905530-2707848", 190462, 4521},
 {"Info3449905594-8189583", 190574, 4524},
 {"Info3449905617-5386397", 190687, 4527}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 327, 6, 49, "Subtitle"],
Cell[897, 30, 542, 12, 49, "Subsubtitle",
 CellTags->"Package Initialization and Definitions"],
Cell[1442, 44, 1148, 20, 49, "Text"],
Cell[CellGroupData[{
Cell[2615, 68, 437, 11, 36, "Subsection",
 InitializationCell->True,
 CellTags->"init"],
Cell[CellGroupData[{
Cell[3077, 83, 4056, 88, 512, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7158, 175, 140, 2, 23, "Print"],
Cell[7301, 179, 120, 1, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[7482, 187, 519, 9, 33, "Section",
 CellTags->"package"],
Cell[CellGroupData[{
Cell[8026, 200, 199, 2, 36, "Subsection"],
Cell[8228, 204, 1781, 42, 232, "Input"],
Cell[CellGroupData[{
Cell[10034, 250, 113, 1, 28, "Subsubsection"],
Cell[10150, 253, 20621, 476, 3246, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30808, 734, 212, 6, 22, "Subsubsection"],
Cell[31023, 742, 682, 15, 112, "Input"],
Cell[31708, 759, 769, 16, 152, "Input"],
Cell[32480, 777, 587, 13, 112, "Input"],
Cell[33070, 792, 952, 21, 152, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[34071, 819, 254, 3, 28, "Subsection"],
Cell[34328, 824, 1303, 33, 172, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[35668, 862, 249, 3, 28, "Subsection"],
Cell[35920, 867, 1609, 37, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[37566, 909, 537, 7, 28, "Subsection"],
Cell[38106, 918, 6972, 154, 752, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[45115, 1077, 416, 5, 28, "Subsection"],
Cell[45534, 1084, 1242, 43, 52, "Input"],
Cell[46779, 1129, 431, 12, 31, "Input"],
Cell[47213, 1143, 798, 22, 52, "Input"],
Cell[48014, 1167, 1803, 42, 175, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49854, 1214, 514, 7, 28, "Subsection"],
Cell[50371, 1223, 1347, 34, 72, "Input"],
Cell[51721, 1259, 1399, 32, 92, "Input"],
Cell[53123, 1293, 1535, 35, 132, "Input"],
Cell[54661, 1330, 663, 19, 52, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[55361, 1354, 708, 14, 30, "Subsection"],
Cell[56072, 1370, 371, 11, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[56480, 1386, 414, 6, 28, "Subsection"],
Cell[56897, 1394, 4033, 98, 512, "Input"],
Cell[60933, 1494, 2115, 58, 349, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[63085, 1557, 394, 7, 28, "Subsection"],
Cell[CellGroupData[{
Cell[63504, 1568, 285, 7, 27, "Subsubsection"],
Cell[63792, 1577, 3549, 81, 392, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[67378, 1663, 263, 3, 21, "Subsubsection"],
Cell[67644, 1668, 967, 27, 132, "Input"],
Cell[68614, 1697, 17901, 419, 1752, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[86552, 2121, 305, 4, 21, "Subsubsection"],
Cell[86860, 2127, 283, 6, 72, "Input"],
Cell[87146, 2135, 19311, 445, 1940, "Input"],
Cell[106460, 2582, 16226, 379, 1780, "Input"],
Cell[122689, 2963, 14232, 329, 1620, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[136958, 3297, 359, 5, 21, "Subsubsection"],
Cell[137320, 3304, 22764, 530, 2205, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160133, 3840, 352, 5, 36, "Subsection"],
Cell[160488, 3847, 17538, 355, 2532, "Input"],
Cell[178029, 4204, 1176, 30, 192, "Input"],
Cell[179208, 4236, 984, 17, 212, "Input"],
Cell[180195, 4255, 694, 13, 152, "Input"],
Cell[180892, 4270, 692, 15, 92, "Input"],
Cell[181587, 4287, 978, 18, 252, "Input"],
Cell[182568, 4307, 2899, 70, 552, "Input"],
Cell[185470, 4379, 242, 6, 52, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[185749, 4390, 408, 6, 28, "Subsection"],
Cell[186160, 4398, 146, 3, 31, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[186355, 4407, 703, 15, 59, "Subsubtitle",
 CellTags->"Package Initialization and Definitions"],
Cell[CellGroupData[{
Cell[187083, 4426, 201, 5, 23, "Print"],
Cell[187287, 4433, 353, 6, 77, "Print",
 CellTags->"Info3449905530-2707848"],
Cell[187643, 4441, 294, 7, 31, "Print"],
Cell[187940, 4450, 339, 6, 109, "Print",
 CellTags->"Info3449905594-8189583"],
Cell[188282, 4458, 276, 7, 31, "Print"],
Cell[188561, 4467, 289, 6, 75, "Print",
 CellTags->"Info3449905617-5386397"]
}, Open  ]]
}, Open  ]],
Cell[188877, 4477, 630, 14, 59, "Subsubtitle",
 CellTags->"Package Initialization and Definitions"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
